{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"index.html","text":"Documentation d\u2019utilisation MaX est r\u00e9gi par la licence open source CeCILL-B. Il est d\u00e9velopp\u00e9 par le Certic et le p\u00f4le Document num\u00e9rique. Avant-propos Cette documentation a \u00e9t\u00e9 r\u00e9dig\u00e9e \u00e0 destination : d\u2019ing\u00e9nieurs en analyse de sources historiques et culturelles, d\u2019\u00e9diteurs de corpus num\u00e9riques par : des d\u00e9veloppeurs, des ing\u00e9nieurs en analyse de sources historiques et culturelles, des \u00e9diteurs de corpus num\u00e9riques qui travaillent : au CERTIC, au P\u00f4le Document num\u00e9rique. Introduction Cette documentation a pour objectif d\u2019expliquer comment d\u00e9ployer une instance* de MaX, comment la configurer et y ajouter de nouvelles fonctionnalit\u00e9s. Attention, cet outil a \u00e9t\u00e9 d\u00e9velopp\u00e9 pour \u00eatre install\u00e9 uniquement sur les syst\u00e8mes d\u2019exploitation Linux et mac OS. MaX, pour Moteur d\u2019Affichage XML, est un moteur d\u2019affichage qui permet la consultation de fichiers XML stock\u00e9s dans une base de donn\u00e9es via un navigateur web. Il repose sur les technologies et les services suivants : stockage : base de donn\u00e9es XML BaseX, couche m\u00e9tier : RestXQ / XQuery / XSLT, couche pr\u00e9sentation : HTML / CSS / Javascript. Pour afficher une page d\u2019une \u00e9dition h\u00e9berg\u00e9e par MaX, le c\u0153ur applicatif de MaX se base sur l\u2019URL interrog\u00e9e. Celle-ci d\u00e9finit le contexte de configuration de base pour l\u2019ensemble des traitements : requ\u00eatage, transformation XSL, g\u00e9n\u00e9ration de pages HTML, ex\u00e9cution des plugins \u00e9ventuels.","title":"Documentation d\u2019utilisation de MaX"},{"location":"index.html#documentation-dutilisation","text":"MaX est r\u00e9gi par la licence open source CeCILL-B. Il est d\u00e9velopp\u00e9 par le Certic et le p\u00f4le Document num\u00e9rique.","title":"Documentation d\u2019utilisation"},{"location":"index.html#avant-propos","text":"Cette documentation a \u00e9t\u00e9 r\u00e9dig\u00e9e \u00e0 destination : d\u2019ing\u00e9nieurs en analyse de sources historiques et culturelles, d\u2019\u00e9diteurs de corpus num\u00e9riques par : des d\u00e9veloppeurs, des ing\u00e9nieurs en analyse de sources historiques et culturelles, des \u00e9diteurs de corpus num\u00e9riques qui travaillent : au CERTIC, au P\u00f4le Document num\u00e9rique.","title":"Avant-propos"},{"location":"index.html#introduction","text":"Cette documentation a pour objectif d\u2019expliquer comment d\u00e9ployer une instance* de MaX, comment la configurer et y ajouter de nouvelles fonctionnalit\u00e9s. Attention, cet outil a \u00e9t\u00e9 d\u00e9velopp\u00e9 pour \u00eatre install\u00e9 uniquement sur les syst\u00e8mes d\u2019exploitation Linux et mac OS. MaX, pour Moteur d\u2019Affichage XML, est un moteur d\u2019affichage qui permet la consultation de fichiers XML stock\u00e9s dans une base de donn\u00e9es via un navigateur web. Il repose sur les technologies et les services suivants : stockage : base de donn\u00e9es XML BaseX, couche m\u00e9tier : RestXQ / XQuery / XSLT, couche pr\u00e9sentation : HTML / CSS / Javascript. Pour afficher une page d\u2019une \u00e9dition h\u00e9berg\u00e9e par MaX, le c\u0153ur applicatif de MaX se base sur l\u2019URL interrog\u00e9e. Celle-ci d\u00e9finit le contexte de configuration de base pour l\u2019ensemble des traitements : requ\u00eatage, transformation XSL, g\u00e9n\u00e9ration de pages HTML, ex\u00e9cution des plugins \u00e9ventuels.","title":"Introduction"},{"location":"basex.html","text":"Ajouter / modifier des fichiers XML dans une \u00e9dition Lors de l\u2019\u00e9tape 3 de la cr\u00e9ation d\u2019une nouvelle \u00e9dition, une base de donn\u00e9es est cr\u00e9\u00e9e par d\u00e9faut. Son nom est celui donn\u00e9e \u00e0 la question \" Database path ? \", et il figure dans la premi\u00e8re ligne du fichier de configuration de l\u2019\u00e9dition (dossier [projet-]editions/[mon-edition] / [mon-edition]_confing_inc.xml ). Cette base de donn\u00e9es contient les fichiers XML qui sont affich\u00e9s dans MaX. Nota Bene \u00c0 chaque mise \u00e0 jour de vos fichiers XML vous devez les r\u00e9-indexer dans votre base de donn\u00e9es BaseX. Pour ajouter des fichiers XML dans BaseX : 1) En ligne de commande, se placer dans le dossier [projet-]BaseX/bin cd [chemin-vers-le-projet]/[projet-]BaseX/bin 2) Si ce n\u2019est pas d\u00e9j\u00e0 fait, lancer BaseX ./basexhttp & 3) Ouvrir BaseX Client ./basexclient -w 4) Renseigner les identifiants et mots de passe de Basex ( par d\u00e9faut admin / admin ) Une fois le client BaseX ouvert, plusieurs actions sont possibles, aux moyens de commandes. Acc\u00e9der \u00e0 la liste des diff\u00e9rentes bases d\u00e9j\u00e0 existantes (par d\u00e9faut, celle cr\u00e9\u00e9e lors de l\u2019\u00e9tape 3 de la cr\u00e9ation d\u2019une \u00e9dition) : list Ouvrir une base (ce qui permettra d\u2019ajouter/de supprimer des fichiers) : open [nom-de-la-base] Cr\u00e9er une nouvelle base : create db [nom-de-la-base] Supprimer une base: drop db [nom-de-la-base] Lister les fichiers disponibles dans une base : list [nom-de-la-base] Ajouter des fichiers dans une base : add to [nom-de-la-base] [chemin-vers-le-fichier] Il est possible d\u2019ajouter un seul fichier XML, ou bien un dossier complet comprenant plusieurs fichiers. Par exemple : add to [nom-de-la-base] /Users/[nom-d'utilisateur]/Documents/FichiersXML/[nom-du-dossier] Supprimer un fichier ou un dossier d\u2019une base : delete [nom-du-fichier] ou delete [nom-du-dossier] => On peut v\u00e9rifier que les fichiers ont bien \u00e9t\u00e9 ajout\u00e9s ou supprim\u00e9s \u00e0 l\u2019aide de la commande list [nom-de-la-base] . Changer le mot de passe d\u2019acc\u00e8s \u00e0 BaseX Client (par d\u00e9faut admin) : password [nouveau-mot-de-passe] Pour quitter BaseX Client, on tape la commande exit . Par d\u00e9faut, les documents ajout\u00e9s dans la base de donn\u00e9es de l\u2019\u00e9dition sont affich\u00e9s dans MaX \u00e0 l\u2019adresse suivante : http://[host]:[port]/[edition]/sommaire.html .","title":"Fichiers XML"},{"location":"basex.html#ajouter-modifier-des-fichiers-xml-dans-une-edition","text":"Lors de l\u2019\u00e9tape 3 de la cr\u00e9ation d\u2019une nouvelle \u00e9dition, une base de donn\u00e9es est cr\u00e9\u00e9e par d\u00e9faut. Son nom est celui donn\u00e9e \u00e0 la question \" Database path ? \", et il figure dans la premi\u00e8re ligne du fichier de configuration de l\u2019\u00e9dition (dossier [projet-]editions/[mon-edition] / [mon-edition]_confing_inc.xml ). Cette base de donn\u00e9es contient les fichiers XML qui sont affich\u00e9s dans MaX. Nota Bene \u00c0 chaque mise \u00e0 jour de vos fichiers XML vous devez les r\u00e9-indexer dans votre base de donn\u00e9es BaseX. Pour ajouter des fichiers XML dans BaseX : 1) En ligne de commande, se placer dans le dossier [projet-]BaseX/bin cd [chemin-vers-le-projet]/[projet-]BaseX/bin 2) Si ce n\u2019est pas d\u00e9j\u00e0 fait, lancer BaseX ./basexhttp & 3) Ouvrir BaseX Client ./basexclient -w 4) Renseigner les identifiants et mots de passe de Basex ( par d\u00e9faut admin / admin ) Une fois le client BaseX ouvert, plusieurs actions sont possibles, aux moyens de commandes. Acc\u00e9der \u00e0 la liste des diff\u00e9rentes bases d\u00e9j\u00e0 existantes (par d\u00e9faut, celle cr\u00e9\u00e9e lors de l\u2019\u00e9tape 3 de la cr\u00e9ation d\u2019une \u00e9dition) : list Ouvrir une base (ce qui permettra d\u2019ajouter/de supprimer des fichiers) : open [nom-de-la-base] Cr\u00e9er une nouvelle base : create db [nom-de-la-base] Supprimer une base: drop db [nom-de-la-base] Lister les fichiers disponibles dans une base : list [nom-de-la-base] Ajouter des fichiers dans une base : add to [nom-de-la-base] [chemin-vers-le-fichier] Il est possible d\u2019ajouter un seul fichier XML, ou bien un dossier complet comprenant plusieurs fichiers. Par exemple : add to [nom-de-la-base] /Users/[nom-d'utilisateur]/Documents/FichiersXML/[nom-du-dossier] Supprimer un fichier ou un dossier d\u2019une base : delete [nom-du-fichier] ou delete [nom-du-dossier] => On peut v\u00e9rifier que les fichiers ont bien \u00e9t\u00e9 ajout\u00e9s ou supprim\u00e9s \u00e0 l\u2019aide de la commande list [nom-de-la-base] . Changer le mot de passe d\u2019acc\u00e8s \u00e0 BaseX Client (par d\u00e9faut admin) : password [nouveau-mot-de-passe] Pour quitter BaseX Client, on tape la commande exit . Par d\u00e9faut, les documents ajout\u00e9s dans la base de donn\u00e9es de l\u2019\u00e9dition sont affich\u00e9s dans MaX \u00e0 l\u2019adresse suivante : http://[host]:[port]/[edition]/sommaire.html .","title":"Ajouter / modifier des fichiers XML dans une \u00e9dition"},{"location":"config.html","text":"Configuration Configuration g\u00e9n\u00e9rale de MaX Le fichier configuration.xml (dans le dossier configuration ) inclut les fichiers de configuration des diff\u00e9rentes \u00e9ditions g\u00e9r\u00e9es par MaX. <!-- Exemple de fichier de configuration de MaX incluant 2 \u00e9ditions : max-tei-demo et mon-edition --> <?xml version=\"1.0\"?> <configuration xmlns:xi=\"http://www.w3.org/2001/XInclude\"> <baseURI/> <editions> <xi:include href=\"../editions/max_tei_demo/max_tei_demo_config_inc.xml\"/> <xi:include href=\"../editions/mon-edition/mon-edition_config_inc.xml\"/> [...] </editions> </configuration> Chaque nouvelle \u00e9dition impl\u00e9ment\u00e9e avec l\u2019outil max.sh ajoute un \u00e9l\u00e9ment <xi:include> . Quand une \u00e9dition d\u00e9j\u00e0 pr\u00e9par\u00e9e est r\u00e9cup\u00e9r\u00e9e, cette ligne peut \u00eatre ajout\u00e9e manuellement. Configuration d\u2019une \u00e9dition L\u2019\u00e9dition mon-edition sera configur\u00e9e gr\u00e2ce au fichier editions / mon-edition / mon-edition_config_inc.xml . <!-- Exemple de fichier de configuration par d\u00e9faut, sans option, ni surcharge, ni plugin--> <edition xml:id=\"mon-edition\" dbpath=\"moneditiondb\" env=\"tei\" prettyName=\"Mon \u00c9dition\"> </edition> @xml:id : identifiant de l\u2019\u00e9dition. Toutes les URLs de consultation commencent par cet identifiant, @dbpath : nom de la base de donn\u00e9es contenant les sources XML consultables @env : grammaire XML de l\u2019\u00e9dition (tei ou ead). Ces trois param\u00e8tres sont d\u00e9finis lors de l\u2019\u00e9tape 3 de la proc\u00e9dure de d\u00e9ploiement d\u2019une nouvelle \u00e9dition . @prettyName : titre de l\u2019\u00e9dition qui pourra \u00eatre r\u00e9cup\u00e9r\u00e9 sous forme de variable et affich\u00e9 \u00e0 divers endroits du site. Ce fichier contiendra si n\u00e9cessaire, la configuration des options de lecture , l\u2019activation et le param\u00e8trage de l\u2019alignement et des plugins .","title":"Configuration"},{"location":"config.html#configuration","text":"","title":"Configuration"},{"location":"config.html#configuration-generale-de-max","text":"Le fichier configuration.xml (dans le dossier configuration ) inclut les fichiers de configuration des diff\u00e9rentes \u00e9ditions g\u00e9r\u00e9es par MaX. <!-- Exemple de fichier de configuration de MaX incluant 2 \u00e9ditions : max-tei-demo et mon-edition --> <?xml version=\"1.0\"?> <configuration xmlns:xi=\"http://www.w3.org/2001/XInclude\"> <baseURI/> <editions> <xi:include href=\"../editions/max_tei_demo/max_tei_demo_config_inc.xml\"/> <xi:include href=\"../editions/mon-edition/mon-edition_config_inc.xml\"/> [...] </editions> </configuration> Chaque nouvelle \u00e9dition impl\u00e9ment\u00e9e avec l\u2019outil max.sh ajoute un \u00e9l\u00e9ment <xi:include> . Quand une \u00e9dition d\u00e9j\u00e0 pr\u00e9par\u00e9e est r\u00e9cup\u00e9r\u00e9e, cette ligne peut \u00eatre ajout\u00e9e manuellement.","title":"Configuration g\u00e9n\u00e9rale de MaX"},{"location":"config.html#configuration-dune-edition","text":"L\u2019\u00e9dition mon-edition sera configur\u00e9e gr\u00e2ce au fichier editions / mon-edition / mon-edition_config_inc.xml . <!-- Exemple de fichier de configuration par d\u00e9faut, sans option, ni surcharge, ni plugin--> <edition xml:id=\"mon-edition\" dbpath=\"moneditiondb\" env=\"tei\" prettyName=\"Mon \u00c9dition\"> </edition> @xml:id : identifiant de l\u2019\u00e9dition. Toutes les URLs de consultation commencent par cet identifiant, @dbpath : nom de la base de donn\u00e9es contenant les sources XML consultables @env : grammaire XML de l\u2019\u00e9dition (tei ou ead). Ces trois param\u00e8tres sont d\u00e9finis lors de l\u2019\u00e9tape 3 de la proc\u00e9dure de d\u00e9ploiement d\u2019une nouvelle \u00e9dition . @prettyName : titre de l\u2019\u00e9dition qui pourra \u00eatre r\u00e9cup\u00e9r\u00e9 sous forme de variable et affich\u00e9 \u00e0 divers endroits du site. Ce fichier contiendra si n\u00e9cessaire, la configuration des options de lecture , l\u2019activation et le param\u00e8trage de l\u2019alignement et des plugins .","title":"Configuration d\u2019une \u00e9dition"},{"location":"features.html","text":"Fonctionnement Fonctionnalit\u00e9s et adresses URL associ\u00e9es Pour la consultation d\u2019une page d\u2019une \u00e9dition, MaX se base sur l\u2019URL interrog\u00e9e. Cette URL va permettre de d\u00e9clencher une route* \u00e0 laquelle correpond un ensemble de traitements (de l\u2019affichage d\u2019une page HTML simple, au requ\u00eatage de la base de donn\u00e9es XML pour g\u00e9n\u00e9rer une nouvelle page HTML via une transformation XSL). L\u2019URL contient syst\u00e9matiquement l\u2019identifiant de l\u2019\u00e9dition consult\u00e9e. Cet identifiant, plus d\u2019autres param\u00e8tres optionnels, permettent de construire le document ad\u00e9quat, en s\u2019appuyant \u00e9galement sur le fichier de configuration de l\u2019\u00e9dition (pour les options d\u2019affichage ou l\u2019utilisation des plugins par exemple). Les principales URLs de consultation sont les suivantes : Page d\u2019accueil d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/accueil.html Sommaire d\u2019une \u00e9dition (liste des documents XML consultables) ( plus d\u2019info ) : http://[host]:[port]/[edition]/sommaire.html Sommaire d\u2019un document d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/sommaire/[document].html Consultation d\u2019un document d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/doc/[document].html Consultation d\u2019un fragment identifi\u00e9 (xml:id) d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/[document].xml/[id].html Consultation d\u2019un contenu html statique* ( plus d\u2019info ) : http://[host]:[port]/[edition]/[page].html Cha\u00eene de traitement Lors de la consultation d\u2019un sommaire, d\u2019un document ou d\u2019un fragment, MaX effectue les op\u00e9rations suivantes : Requ\u00eatage XQUERY pour la r\u00e9cup\u00e9ration des donn\u00e9es (liste de documents, document complet, fragment identifi\u00e9, etc.). Transformation de ces donn\u00e9es en un contenu HTML par application de templates XSLT. Cr\u00e9ation d\u2019une page HTML compl\u00e8te (\u00e0 partir d\u2019un template HTML) contenant les donn\u00e9es transform\u00e9es, les blocs de navigation, menu, etc. ainsi que les imports CSS et Javascript n\u00e9cessaires. Ex\u00e9cution des fonctionnalit\u00e9s javascripts au sein du navigateur.","title":"Fonctionnement"},{"location":"features.html#fonctionnement","text":"","title":"Fonctionnement"},{"location":"features.html#fonctionnalites-et-adresses-url-associees","text":"Pour la consultation d\u2019une page d\u2019une \u00e9dition, MaX se base sur l\u2019URL interrog\u00e9e. Cette URL va permettre de d\u00e9clencher une route* \u00e0 laquelle correpond un ensemble de traitements (de l\u2019affichage d\u2019une page HTML simple, au requ\u00eatage de la base de donn\u00e9es XML pour g\u00e9n\u00e9rer une nouvelle page HTML via une transformation XSL). L\u2019URL contient syst\u00e9matiquement l\u2019identifiant de l\u2019\u00e9dition consult\u00e9e. Cet identifiant, plus d\u2019autres param\u00e8tres optionnels, permettent de construire le document ad\u00e9quat, en s\u2019appuyant \u00e9galement sur le fichier de configuration de l\u2019\u00e9dition (pour les options d\u2019affichage ou l\u2019utilisation des plugins par exemple). Les principales URLs de consultation sont les suivantes : Page d\u2019accueil d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/accueil.html Sommaire d\u2019une \u00e9dition (liste des documents XML consultables) ( plus d\u2019info ) : http://[host]:[port]/[edition]/sommaire.html Sommaire d\u2019un document d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/sommaire/[document].html Consultation d\u2019un document d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/doc/[document].html Consultation d\u2019un fragment identifi\u00e9 (xml:id) d\u2019une \u00e9dition ( plus d\u2019info ) : http://[host]:[port]/[edition]/[document].xml/[id].html Consultation d\u2019un contenu html statique* ( plus d\u2019info ) : http://[host]:[port]/[edition]/[page].html","title":"Fonctionnalit\u00e9s et adresses URL associ\u00e9es"},{"location":"features.html#chaine-de-traitement","text":"Lors de la consultation d\u2019un sommaire, d\u2019un document ou d\u2019un fragment, MaX effectue les op\u00e9rations suivantes : Requ\u00eatage XQUERY pour la r\u00e9cup\u00e9ration des donn\u00e9es (liste de documents, document complet, fragment identifi\u00e9, etc.). Transformation de ces donn\u00e9es en un contenu HTML par application de templates XSLT. Cr\u00e9ation d\u2019une page HTML compl\u00e8te (\u00e0 partir d\u2019un template HTML) contenant les donn\u00e9es transform\u00e9es, les blocs de navigation, menu, etc. ainsi que les imports CSS et Javascript n\u00e9cessaires. Ex\u00e9cution des fonctionnalit\u00e9s javascripts au sein du navigateur.","title":"Cha\u00eene de traitement"},{"location":"files.html","text":"Organisation des dossiers et des fichiers Le dossier projet-MaX L\u2019application MaX s\u2019organise selon l\u2019arborescence suivante : graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; max-->A max-->B max-->C max-->E max-->F max-->G max-->H max-->I max-->J A-->A1 C-.->C1 H-->H1 H-->H3 H-->H4 H-->H5 H-->H6 H-->H7 H-->H8 max[\"projet-MaX\"] A[\"configuration\"] A1(\"fichiers de configuration configuration.xml\") B[\"documentation\"] C[\"editions\"] C1[\"un dossier par \u00e9dition lien(s) symbolique(s) vers le dossier projet-editions\"] E[\"plugins\"] F[\"rxq\"] G[\"tools\"] H[\"ui\"] H1[\"css\"] H3[\"i18n\"] H4[\"images\"] H5[\"js\"] H6[\"lib\"] H7[\"templates\"] H8[\"xsl\"] J(\"max.xq\") configuration : contient le/les fichiers de configuration, documentation : contient la documentation de MaX, editions : contient les \u00e9ditions h\u00e9berg\u00e9es par l\u2019instance de MaX. Chaque \u00e9dition a son propre dossier dans lequel sont stock\u00e9es ses ressources propres : HTML, XSLT, CSS, Javascript, XQuery, etc. Voir Cr\u00e9ation d\u2019une edition , plugins : contient les plugins . Chaque plugin dispose de son propre dossier de ressources : fichiers Javascript, XQuery, XSL, ... Voir la partie Plugins , rxq : contient l\u2019ensemble des modules RestXQ, tools : contient les outils de d\u00e9ploiement : \u00e9dition de d\u00e9monstration, nouvelle \u00e9dition, activation et d\u00e9sactivation de plugins, ui : css : feuilles de style natives de MaX, i18n : ressources d\u2019internationalisation, images : images de MaX : logo et ic\u00f4nes de navigation, js : sources Javascript de MaX, lib : librairies externes, templates : templates HTML* , xsl : feuilles de transformations XSL natives de MaX. => On retrouve la m\u00eame organisation (dossier ui ) de ces sous-dossiers pour la configuration d\u2019une \u00e9dition particuli\u00e8re (cf. ci-dessous Le dossier [projet]-editions ) max.xq : \u00ab contr\u00f4leur \u00bb RestXQ* de MaX. Le moteur d\u2019affichage XML est construit pour permettre l\u2019exposition de n\u2019importe quel vocabulaire XML. N\u00e9anmoins, deux vocabulaires ont fait l\u2019objet de d\u00e9veloppements particuliers : EAD et TEI. Dans les dossiers rxq , ui/css , ui/js , ui/templates , ui/xsl , l\u2019utilisateur peut trouver des dossiers ou fichiers sp\u00e9cifiques pour ces deux vocabulaires. Le dossier [projet-]MaX constitue le c\u0153ur applicatif ( core ) de MaX. La configuration sp\u00e9cifique de chaque \u00e9dition se fera donc \u00e0 l\u2019ext\u00e9rieur du core dans le dossier [projet-]editions . Il est ainsi fortement conseill\u00e9 de ne modifier que ces deux dossiers : editions , plugins . Le dossier [projet-]editions graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; edition[\"[projet-]editions\"] A[\"mon-edition\"] edition-->A A-->B A-->C A-->D A-->E A-->F D-->D1 D-->D2 D-->D3 D1-->D4 D2-->D5 E-->E1 E-->E2 E-->E3 E-->E4 E-->E5 E-->E6 E-->E7 E1-->E8 E7-->E9 E7-->E10 E7-->E11 B(\"mon-edition_config_inc.xml\") C(\"menu.xml\") D[\"fragments\"] D1[\"fr\"] D2[\"en\"] D3(\"footer.frag.html\") D4(\"fichiers .frag.html\") D5(\"fichiers .frag.html\") E[\"ui\"] E1[\"css\"] E2[\"fonts\"] E3[\"i18n\"] E4[\"images\"] E5[\"js\"] E6[\"templates\"] E7[\"xsl\"] E8(\"mon-edition.css\") E9[\"core\"] E10[\"ead\"] E11[\"tei\"] F[\"xq\"] mon-edition_config_inc.xml : le fichier de configuration de l\u2019\u00e9dition qui permet de : pr\u00e9ciser le nom de la base de donn\u00e9es, le vocabulaire utilis\u00e9, le prettyName (titre de l\u2019\u00e9dition r\u00e9cup\u00e9r\u00e9 sous forme de variable et affich\u00e9 \u00e0 divers endroits du site), activer les plugins, etc., fragments : contient les pages statiques, menu.xml : le fichier pour configurer le menu, ui : contient les dossiers pour les css, les xsl, le template html, les images, les polices, etc., xq : contient les fichiers de requ\u00eates sp\u00e9cifiques \u00e0 l\u2019\u00e9dition.","title":"Organisation des dossiers et des fichiers"},{"location":"files.html#organisation-des-dossiers-et-des-fichiers","text":"","title":"Organisation des dossiers et des fichiers"},{"location":"files.html#le-dossier-projet-max","text":"L\u2019application MaX s\u2019organise selon l\u2019arborescence suivante : graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; max-->A max-->B max-->C max-->E max-->F max-->G max-->H max-->I max-->J A-->A1 C-.->C1 H-->H1 H-->H3 H-->H4 H-->H5 H-->H6 H-->H7 H-->H8 max[\"projet-MaX\"] A[\"configuration\"] A1(\"fichiers de configuration configuration.xml\") B[\"documentation\"] C[\"editions\"] C1[\"un dossier par \u00e9dition lien(s) symbolique(s) vers le dossier projet-editions\"] E[\"plugins\"] F[\"rxq\"] G[\"tools\"] H[\"ui\"] H1[\"css\"] H3[\"i18n\"] H4[\"images\"] H5[\"js\"] H6[\"lib\"] H7[\"templates\"] H8[\"xsl\"] J(\"max.xq\") configuration : contient le/les fichiers de configuration, documentation : contient la documentation de MaX, editions : contient les \u00e9ditions h\u00e9berg\u00e9es par l\u2019instance de MaX. Chaque \u00e9dition a son propre dossier dans lequel sont stock\u00e9es ses ressources propres : HTML, XSLT, CSS, Javascript, XQuery, etc. Voir Cr\u00e9ation d\u2019une edition , plugins : contient les plugins . Chaque plugin dispose de son propre dossier de ressources : fichiers Javascript, XQuery, XSL, ... Voir la partie Plugins , rxq : contient l\u2019ensemble des modules RestXQ, tools : contient les outils de d\u00e9ploiement : \u00e9dition de d\u00e9monstration, nouvelle \u00e9dition, activation et d\u00e9sactivation de plugins, ui : css : feuilles de style natives de MaX, i18n : ressources d\u2019internationalisation, images : images de MaX : logo et ic\u00f4nes de navigation, js : sources Javascript de MaX, lib : librairies externes, templates : templates HTML* , xsl : feuilles de transformations XSL natives de MaX. => On retrouve la m\u00eame organisation (dossier ui ) de ces sous-dossiers pour la configuration d\u2019une \u00e9dition particuli\u00e8re (cf. ci-dessous Le dossier [projet]-editions ) max.xq : \u00ab contr\u00f4leur \u00bb RestXQ* de MaX. Le moteur d\u2019affichage XML est construit pour permettre l\u2019exposition de n\u2019importe quel vocabulaire XML. N\u00e9anmoins, deux vocabulaires ont fait l\u2019objet de d\u00e9veloppements particuliers : EAD et TEI. Dans les dossiers rxq , ui/css , ui/js , ui/templates , ui/xsl , l\u2019utilisateur peut trouver des dossiers ou fichiers sp\u00e9cifiques pour ces deux vocabulaires. Le dossier [projet-]MaX constitue le c\u0153ur applicatif ( core ) de MaX. La configuration sp\u00e9cifique de chaque \u00e9dition se fera donc \u00e0 l\u2019ext\u00e9rieur du core dans le dossier [projet-]editions . Il est ainsi fortement conseill\u00e9 de ne modifier que ces deux dossiers : editions , plugins .","title":"Le dossier projet-MaX"},{"location":"files.html#le-dossier-projet-editions","text":"graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; edition[\"[projet-]editions\"] A[\"mon-edition\"] edition-->A A-->B A-->C A-->D A-->E A-->F D-->D1 D-->D2 D-->D3 D1-->D4 D2-->D5 E-->E1 E-->E2 E-->E3 E-->E4 E-->E5 E-->E6 E-->E7 E1-->E8 E7-->E9 E7-->E10 E7-->E11 B(\"mon-edition_config_inc.xml\") C(\"menu.xml\") D[\"fragments\"] D1[\"fr\"] D2[\"en\"] D3(\"footer.frag.html\") D4(\"fichiers .frag.html\") D5(\"fichiers .frag.html\") E[\"ui\"] E1[\"css\"] E2[\"fonts\"] E3[\"i18n\"] E4[\"images\"] E5[\"js\"] E6[\"templates\"] E7[\"xsl\"] E8(\"mon-edition.css\") E9[\"core\"] E10[\"ead\"] E11[\"tei\"] F[\"xq\"] mon-edition_config_inc.xml : le fichier de configuration de l\u2019\u00e9dition qui permet de : pr\u00e9ciser le nom de la base de donn\u00e9es, le vocabulaire utilis\u00e9, le prettyName (titre de l\u2019\u00e9dition r\u00e9cup\u00e9r\u00e9 sous forme de variable et affich\u00e9 \u00e0 divers endroits du site), activer les plugins, etc., fragments : contient les pages statiques, menu.xml : le fichier pour configurer le menu, ui : contient les dossiers pour les css, les xsl, le template html, les images, les polices, etc., xq : contient les fichiers de requ\u00eates sp\u00e9cifiques \u00e0 l\u2019\u00e9dition.","title":"Le dossier [projet-]editions"},{"location":"glossary.html","text":"Glossaire B baseURI (ou variable baseURI) : portion d\u2019URL (ou chemin) d\u2019une page html qui se trouve avant la route* et apr\u00e8s la racine de l\u2019h\u00f4te* . Exemple dans \"https://www.unicaen.fr/puc/sources/castel/accueil\", il s\u2019agit de \"/puc/sources\". breadcrumb (Fil d\u2019Ariane) : dans l\u2019interface de MaX, aide \u00e0 la navigation sous forme de menu arborescent. Le fil d\u2019ariane permet au lecteur de localiser les documents (les pages web du site) et de se situer par rapport \u00e0 ces documents. C contenu html statique (ou page statique) : page web dont le contenu n\u2019est pas g\u00e9n\u00e9r\u00e9 dynamiquement. Dans Max, cela signifie que ce contenu n\u2019est pas reconstitu\u00e9 depuis les fichiers XML index\u00e9s dans BaseX. contr\u00f4leur RestXQ : d\u00e9crit la logique concernant les actions effectu\u00e9es par l\u2019utilisateur, il fait la correspondance entre l\u2019URL demand\u00e9e et le code ex\u00e9cut\u00e9. D d\u00e9pendances : certains plugins de MaX ont des d\u00e9pendances vers des librairies Javascript. On utilise ind\u00e9pendamment les termes de \"d\u00e9pendances\" ou de \"librairies\" pour renvoyer \u00e0 des logiciels externes \u00e0 MaX, dont il a besoin pour faire fonctionner certaines fonctionnalit\u00e9s. I i18n = internationalisation : mise en place du syst\u00e8me permettant \u00e0 un logiciel de s\u2019adapter \u00e0 des langues diff\u00e9rentes. L\u2019objectif est de pouvoir inclure plusieurs langues dans l\u2019interface. instance : ex\u00e9cution d\u2019un programme. Une \u00ab instance de MaX \u00bb est d\u00e9ploy\u00e9e pour chaque [projet]. L lien symbolique : syst\u00e8me permettant de pointer vers un seul et m\u00eame fichier/dossier depuis plusieurs endroits, pour \u00e9viter d\u2019\u00e9diter ce m\u00eame fichier/dossier plusieurs fois ou pour \u00e9viter d\u2019avoir \u00e0 d\u00e9placer des fichiers/dossiers. Un seul fichier est \u00e9dit\u00e9, et les modifications apport\u00e9es apparaissent dans tous les dossiers o\u00f9 un lien symbolique a \u00e9t\u00e9 cr\u00e9\u00e9 vers ce fichier. Dans l\u2019organisation des dossiers et fichiers propos\u00e9s dans MaX, on retrouve par exemple un lien symbolique qui pointe depuis le dossier [projet-]editions/[mon-edition] vers le sous-dossier [projet-]MaX/editions/[mon-edition] . (Voir Organisation des dossiers et des fichiers .) Si un fichier est modifi\u00e9 depuis le dossier [projet-]editions/[mon-edition] , les modifications apparaitront \u00e9galement dans le dossier [projet-]MaX/editions/[mon-edition] . P port : notion qui concerne les applications r\u00e9seaux. C'est un point d'entr\u00e9 \u00e0 un service. Chaque port a un num\u00e9ro qui correspond \u00e0 une application. Les num\u00e9ros de port de 0 \u00e0 1 023 correspondent aux ports \u00ab bien-connus \u00bb, utilis\u00e9s pour les services r\u00e9seaux les plus courants. BaseX a besoin de plusieurs ports pour fonctionner. prettyName : contrairement au nom de l\u2019\u00e9dition, ce nom est exprim\u00e9 par une suite lisible de caract\u00e8res dans lequel les signes diachritiques sont autoris\u00e9s. Dans MaX, le prettyName renvoie au titre de l\u2019\u00e9dition qui sera affich\u00e9 \u00e0 divers endroits du site. R racine de l\u2019h\u00f4te : premi\u00e8re portion de l\u2019URL (ou chemin) qui correspond \u00e0 l\u2019adresse IP d\u2019une ressource disponible sur Internet. Exemple dans \"https://www.unicaen.fr/puc/sources/castel/accueil\", il s\u2019agit de \"https://www.unicaen.fr\". reverse-proxy : machine qui se fait passer pour une autre et qui transmet des requ\u00eates entre le serveur et le client. Dans le cas de MaX, en production, il s\u2019agit d\u2019Apache. route : portion de l\u2019URL (ou chemin) correspondant \u00e0 une action effectu\u00e9e par MaX. Une route peut contenir des arguments, facultatifs ou non, repr\u00e9sent\u00e9s par les accolades {argument} et dont la valeur peut \u00eatre soumise \u00e0 des contraintes. Exemple dans \"https://www.unicaen.fr/puc/sources/castel/accueil\", il s\u2019agit de \"castel/accueil\". S serveur http (de BaseX) : logiciel qui prend des requ\u00eates HTTP et qui renvoient des r\u00e9ponses HTTP. Dans le cas de MaX, c\u2019est Jetty. surcharge : modification du comportement par d\u00e9faut (ici de MaX) en cr\u00e9ant un second fichier qui sera interpr\u00e9t\u00e9 \u00e0 la place du fichier par d\u00e9faut, et qui permettra de red\u00e9finir le comportement ou l\u2019affichage. T template : gabarit ou patron. On parle de templates HTML, XSLT ou encore CSS pour mod\u00e9liser des documents ind\u00e9pendamment de la valeur des donn\u00e9es.","title":"Glossaire"},{"location":"glossary.html#glossaire","text":"","title":"Glossaire"},{"location":"glossary.html#b","text":"baseURI (ou variable baseURI) : portion d\u2019URL (ou chemin) d\u2019une page html qui se trouve avant la route* et apr\u00e8s la racine de l\u2019h\u00f4te* . Exemple dans \"https://www.unicaen.fr/puc/sources/castel/accueil\", il s\u2019agit de \"/puc/sources\". breadcrumb (Fil d\u2019Ariane) : dans l\u2019interface de MaX, aide \u00e0 la navigation sous forme de menu arborescent. Le fil d\u2019ariane permet au lecteur de localiser les documents (les pages web du site) et de se situer par rapport \u00e0 ces documents.","title":"B"},{"location":"glossary.html#c","text":"contenu html statique (ou page statique) : page web dont le contenu n\u2019est pas g\u00e9n\u00e9r\u00e9 dynamiquement. Dans Max, cela signifie que ce contenu n\u2019est pas reconstitu\u00e9 depuis les fichiers XML index\u00e9s dans BaseX. contr\u00f4leur RestXQ : d\u00e9crit la logique concernant les actions effectu\u00e9es par l\u2019utilisateur, il fait la correspondance entre l\u2019URL demand\u00e9e et le code ex\u00e9cut\u00e9.","title":"C"},{"location":"glossary.html#d","text":"d\u00e9pendances : certains plugins de MaX ont des d\u00e9pendances vers des librairies Javascript. On utilise ind\u00e9pendamment les termes de \"d\u00e9pendances\" ou de \"librairies\" pour renvoyer \u00e0 des logiciels externes \u00e0 MaX, dont il a besoin pour faire fonctionner certaines fonctionnalit\u00e9s.","title":"D"},{"location":"glossary.html#i","text":"i18n = internationalisation : mise en place du syst\u00e8me permettant \u00e0 un logiciel de s\u2019adapter \u00e0 des langues diff\u00e9rentes. L\u2019objectif est de pouvoir inclure plusieurs langues dans l\u2019interface. instance : ex\u00e9cution d\u2019un programme. Une \u00ab instance de MaX \u00bb est d\u00e9ploy\u00e9e pour chaque [projet].","title":"I"},{"location":"glossary.html#l","text":"lien symbolique : syst\u00e8me permettant de pointer vers un seul et m\u00eame fichier/dossier depuis plusieurs endroits, pour \u00e9viter d\u2019\u00e9diter ce m\u00eame fichier/dossier plusieurs fois ou pour \u00e9viter d\u2019avoir \u00e0 d\u00e9placer des fichiers/dossiers. Un seul fichier est \u00e9dit\u00e9, et les modifications apport\u00e9es apparaissent dans tous les dossiers o\u00f9 un lien symbolique a \u00e9t\u00e9 cr\u00e9\u00e9 vers ce fichier. Dans l\u2019organisation des dossiers et fichiers propos\u00e9s dans MaX, on retrouve par exemple un lien symbolique qui pointe depuis le dossier [projet-]editions/[mon-edition] vers le sous-dossier [projet-]MaX/editions/[mon-edition] . (Voir Organisation des dossiers et des fichiers .) Si un fichier est modifi\u00e9 depuis le dossier [projet-]editions/[mon-edition] , les modifications apparaitront \u00e9galement dans le dossier [projet-]MaX/editions/[mon-edition] .","title":"L"},{"location":"glossary.html#p","text":"port : notion qui concerne les applications r\u00e9seaux. C'est un point d'entr\u00e9 \u00e0 un service. Chaque port a un num\u00e9ro qui correspond \u00e0 une application. Les num\u00e9ros de port de 0 \u00e0 1 023 correspondent aux ports \u00ab bien-connus \u00bb, utilis\u00e9s pour les services r\u00e9seaux les plus courants. BaseX a besoin de plusieurs ports pour fonctionner. prettyName : contrairement au nom de l\u2019\u00e9dition, ce nom est exprim\u00e9 par une suite lisible de caract\u00e8res dans lequel les signes diachritiques sont autoris\u00e9s. Dans MaX, le prettyName renvoie au titre de l\u2019\u00e9dition qui sera affich\u00e9 \u00e0 divers endroits du site.","title":"P"},{"location":"glossary.html#r","text":"racine de l\u2019h\u00f4te : premi\u00e8re portion de l\u2019URL (ou chemin) qui correspond \u00e0 l\u2019adresse IP d\u2019une ressource disponible sur Internet. Exemple dans \"https://www.unicaen.fr/puc/sources/castel/accueil\", il s\u2019agit de \"https://www.unicaen.fr\". reverse-proxy : machine qui se fait passer pour une autre et qui transmet des requ\u00eates entre le serveur et le client. Dans le cas de MaX, en production, il s\u2019agit d\u2019Apache. route : portion de l\u2019URL (ou chemin) correspondant \u00e0 une action effectu\u00e9e par MaX. Une route peut contenir des arguments, facultatifs ou non, repr\u00e9sent\u00e9s par les accolades {argument} et dont la valeur peut \u00eatre soumise \u00e0 des contraintes. Exemple dans \"https://www.unicaen.fr/puc/sources/castel/accueil\", il s\u2019agit de \"castel/accueil\".","title":"R"},{"location":"glossary.html#s","text":"serveur http (de BaseX) : logiciel qui prend des requ\u00eates HTTP et qui renvoient des r\u00e9ponses HTTP. Dans le cas de MaX, c\u2019est Jetty. surcharge : modification du comportement par d\u00e9faut (ici de MaX) en cr\u00e9ant un second fichier qui sera interpr\u00e9t\u00e9 \u00e0 la place du fichier par d\u00e9faut, et qui permettra de red\u00e9finir le comportement ou l\u2019affichage.","title":"S"},{"location":"glossary.html#t","text":"template : gabarit ou patron. On parle de templates HTML, XSLT ou encore CSS pour mod\u00e9liser des documents ind\u00e9pendamment de la valeur des donn\u00e9es.","title":"T"},{"location":"home_page.html","text":"Page d\u2019accueil La page d\u2019accueil d\u2019une \u00e9dition est accessible depuis : http://[host]:[port]/[edition]/accueil.html Par exemple : http://localhost:17002/mon-edition/accueil.html Par d\u00e9faut, la page d\u2019accueil affiche la liste des fichiers XML contenus dans BaseX (voir Fichiers XML ). Elle a alors le m\u00eame comportement que lorsque l\u2019on clique sur Sommaire : http://[host]:[port]/[edition]/sommaire.html Pour avoir une page d\u2019accueil sp\u00e9cifique, il suffit d\u2019ajouter dans le dossier fragments du dossier de l\u2019\u00e9dition, dans un dossier de la langue choisie (par exemple fr pour fran\u00e7ais, ou en pour anglais) un fichier accueil.frag.html . [projet-]editions / [edition] / fragments / [langue-locale] / accueil.frag.html graph LR; A-->B B-->C C-->D D-->E A[\"projet-editions\"] B[\"mon-edition\"] C[\"fragments\"] D[\"[langue-locale]\"] E(\"accueil.frag.html\") Le fichier doit obligatoirement commencer par une <div> qui englobera l\u2019ensemble du texte. <!-- Exemple d'un fichier accueil.frag.html --> <div id=\"accueil\"> <h1>Ma page d\u2019accueil</h1> <p>Texte de pr\u00e9sentation de l\u2019\u00e9dition. Texte de pr\u00e9sentation de l\u2019\u00e9dition.</p> <p>Texte de pr\u00e9sentation de l\u2019\u00e9dition. Texte de pr\u00e9sentation de l\u2019\u00e9dition.</p> </div> Nota bene Par d\u00e9faut, l\u2019URL http://[host]:[port]/[edition] redirige automatiquement vers http://[host]:[port]/[edition]/accueil.html","title":"Page d\u2019accueil"},{"location":"home_page.html#page-daccueil","text":"La page d\u2019accueil d\u2019une \u00e9dition est accessible depuis : http://[host]:[port]/[edition]/accueil.html Par exemple : http://localhost:17002/mon-edition/accueil.html Par d\u00e9faut, la page d\u2019accueil affiche la liste des fichiers XML contenus dans BaseX (voir Fichiers XML ). Elle a alors le m\u00eame comportement que lorsque l\u2019on clique sur Sommaire : http://[host]:[port]/[edition]/sommaire.html Pour avoir une page d\u2019accueil sp\u00e9cifique, il suffit d\u2019ajouter dans le dossier fragments du dossier de l\u2019\u00e9dition, dans un dossier de la langue choisie (par exemple fr pour fran\u00e7ais, ou en pour anglais) un fichier accueil.frag.html . [projet-]editions / [edition] / fragments / [langue-locale] / accueil.frag.html graph LR; A-->B B-->C C-->D D-->E A[\"projet-editions\"] B[\"mon-edition\"] C[\"fragments\"] D[\"[langue-locale]\"] E(\"accueil.frag.html\") Le fichier doit obligatoirement commencer par une <div> qui englobera l\u2019ensemble du texte. <!-- Exemple d'un fichier accueil.frag.html --> <div id=\"accueil\"> <h1>Ma page d\u2019accueil</h1> <p>Texte de pr\u00e9sentation de l\u2019\u00e9dition. Texte de pr\u00e9sentation de l\u2019\u00e9dition.</p> <p>Texte de pr\u00e9sentation de l\u2019\u00e9dition. Texte de pr\u00e9sentation de l\u2019\u00e9dition.</p> </div> Nota bene Par d\u00e9faut, l\u2019URL http://[host]:[port]/[edition] redirige automatiquement vers http://[host]:[port]/[edition]/accueil.html","title":"Page d\u2019accueil"},{"location":"i18n.html","text":"Le fichier i18n Fonctionnement Le fichier i18n.xml permet de faire le lien entre des termes d\u00e9finis de mani\u00e8re g\u00e9n\u00e9rique et leur rendu dans la langue d\u00e9finie sur le moteur d\u2019affichage. Il permet par exemple de g\u00e9rer l\u2019affichage des \u00e9l\u00e9ments du menu ou des titres du sommaire dans la langue choisie par l\u2019utilisateur. Il faut donc autant de fichier i18n.xml que de langue(s) d\u00e9finie(s) dans l\u2019\u00e9dition. Exemple d\u2019un fichier i18n en fran\u00e7ais : <!-- Fichier i18n-fr.xml --> <properties> <!-- Menu et sous-menu --> <entry key=\"menu.accueil\">Accueil</entry> <entry key=\"menu.sommaire\">Sommaire</entry> <entry key=\"menu.meta\">Description scientifique</entry> <entry key=\"menu.porte-documents\">Porte-documents</entry> <!-- Sommaire --> <entry key=\"toc.titre\">Recherche par cat\u00e9gories</entry> <entry key=\"toc.ART\">Art - Litt\u00e9rature</entry> <entry key=\"toc.DROIT\">Droit - Formation professionnelle</entry> <entry key=\"toc.ELEVAGE\">\u00c9levage - soins</entry> <entry key=\"toc.EQUITATION\">\u00c9quitation, courses</entry> </properties> Dans la balise entry , l\u2019attribut key contient le terme g\u00e9n\u00e9rique : un seul terme qui se retrouvera dans les diff\u00e9rents fichiers i18n des diff\u00e9rentes langues. En revanche, le texte \u00e0 l\u2019int\u00e9rieur des balises entry change en fonction de la langue d\u00e9finie par l\u2019utilisateur sur MaX. Deux fichiers existent par d\u00e9faut dans le c\u0153ur de MaX, pour des \u00e9ditions en fran\u00e7ais et en anglais : Pour une \u00e9dition en fran\u00e7ais : [projet-]MaX / ui / i18n / i18n-fr.xml Pour une \u00e9dition en anglais : [projet-]MaX / ui / i18n / i18n-en.xml Pour surcharger les fichiers XML, il faut cr\u00e9er un fichier i18n[-langueLocale].xml dans le dossier [projet-]editions / [edition] / ui / i18n (par exemple i18n-fr.xml ou i18n-en.xml ). => Pour chaque nouveau fichier i18n, le pr\u00e9fixe utilis\u00e9 doit correspondre au code ISO alpha-2 de la langue utilis\u00e9e (ici fr et en ). Ces fichiers sont ensuite transform\u00e9s par la feuille XSL i18n.xsl , qui se trouve dans le dossier [projet-]MaX / ui / xsl / core . Pour que les \u00e9l\u00e9ments du i18n soient pris en compte, il est n\u00e9cessaire de cr\u00e9er, dans le dossier fragments de chaque \u00e9dition, un dossier correspondant \u00e0 la langue du i18n (en respectant toujours les codes de la norme ISO ). Par exemple : [projet-]editions / [edition] / fragments / fr pour une \u00e9dition en fran\u00e7ais. Le nom donn\u00e9 \u00e0 ce dossier sera celui accol\u00e9 au nom du fichier i18n.xml . Pour un dossier fragments / en , on aura un fichier ui / i18n / i18n-en.xml . Pour chaque page HTML statique (accueil, contact, bibliographie...), il faudra cr\u00e9er autant de fichiers avec l\u2019extension .frag.html que de langue(s) d\u00e9finie(s). Par exemple, pour une \u00e9dition en fran\u00e7ais et en anglais qui propose une page Contact , on placera un fichier contact.frag.html , r\u00e9dig\u00e9 en fran\u00e7ais, dans le dossier fragments/fr et un fichier contact.frag.html , r\u00e9dig\u00e9 en anglais, dans le dossier fragments/en . graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; edition-->A edition-->B A-->A1 A-->A2 A1-->A3 A2-->A4 B-->B1 B1-->B2 edition[\"projet-editions/edition\"] A[\"fragments\"] A1[\"fr\"] A2[\"en\"] A3(\"fichiers .frag.html en fran\u00e7ais\") A4(\"fichiers .frag.html en anglais\") B[\"ui\"] B1[i18n] B2(\"fichiers i18n-fr.xml + i18n-en.xml\") Modifier la langue \u00e0 afficher par d\u00e9faut Par d\u00e9faut, lors de l\u2019arriv\u00e9e sur le site de l\u2019\u00e9dition, MaX affiche le contenu du fichier i18n-fr.xml , et les fragments du dossier fragments/fr . Pour modifier ce comportement et afficher une autre langue par d\u00e9faut, il faut ajouter le param\u00e8tre @lang au fichier de configuration [mon-edition]_config-inc.xml , dans le dossier [projet-]editions/[mon-edition] . Par exemple, pour une version par d\u00e9faut en anglais : <edition xml:id=\"mon-edition\" dbpath=\"monedition\" env=\"ead\" prettyName=\"My edition in EAD\" lang=\"en\"> La valeur de l\u2019attribut @lang doit correspondre au code ISO de la langue utilis\u00e9e (ici en ), qui sera \u00e9galement le nom du dossier dans le dossier fragments et le pr\u00e9fixe du fichier i18n.xml . Ce param\u00e8tre de l\u2019attribut @lang est facultatif : s\u2019il n\u2019est pas ajout\u00e9, MaX affiche par d\u00e9faut la version en fran\u00e7ais. Exemples D\u00e9finir l\u2019affichage du menu Pour d\u00e9finir l\u2019affichage du menu en fonction de la langue, dans les balises <id> du fichier menu.xml , on d\u00e9clare des termes g\u00e9n\u00e9riques (\"accueil\", \"sommaire\"...). <!-- Exemple d\u2019un fichier menu.xml --> <menu> <entry type=\"main\"> <id>accueil</id> <target>accueil.html</target> </entry> <entry type=\"main\"> <id>sommaire</id> <target>sommaire.html</target> </entry> </menu> Ces termes g\u00e9n\u00e9riques doivent ensuite \u00eatre d\u00e9clar\u00e9s dans les balises <entry> des diff\u00e9rents fichiers i18n.xml , pour d\u00e9finir le texte \u00e0 afficher dans chaque langue. Ce qui donnera dans les deux fichiers i18n.xml , en fran\u00e7ais et en anglais : <!-- Exemple d\u2019un fichier i18n-fr.xml --> <properties> <entry key=\"menu.accueil\">Accueil</entry> <entry key=\"menu.sommaire\">Sommaire</entry> </properties> <!-- Exemple d\u2019un fichier i18n-en.xml --> <properties> <entry key=\"menu.accueil\">Home</entry> <entry key=\"menu.sommaire\">Summary</entry> </properties> D\u00e9finir l\u2019affichage du sommaire Pour d\u00e9finir le titre de la page de sommaire d\u2019une \u00e9dition en fonction de la langue, on d\u00e9clare un terme g\u00e9n\u00e9rique dans une balise <xsl:value-of> , dans le fichier toc.xsl . Par exemple, \" toc.title \". <!-- Exemple d\u2019un fichier toc.xsl --> <xsl:template match=\"/\"> <div id=\"toc\"> <h1> <xsl:value-of select=\"max:i18n($project,'toc.title',$locale)\"/> </h1> </div> </xsl:template> Ce terme g\u00e9n\u00e9rique doit ensuite \u00eatre d\u00e9clar\u00e9 dans une balise <entry> des diff\u00e9rents fichiers i18n.xml. Ce qui donnera dans les deux fichiers i18n.xml , en fran\u00e7ais et en anglais : <!-- Exemple d\u2019un fichier i18n-fr.xml --> <properties> <entry key=\"toc.titre\">Cadre de classement</entry> </properties> <!-- Exemple d\u2019un fichier i18n-en.xml --> <properties> <entry key=\"toc.titre\">File plan</entry> </properties>","title":"Fichier i18n"},{"location":"i18n.html#le-fichier-i18n","text":"","title":"Le fichier i18n"},{"location":"i18n.html#fonctionnement","text":"Le fichier i18n.xml permet de faire le lien entre des termes d\u00e9finis de mani\u00e8re g\u00e9n\u00e9rique et leur rendu dans la langue d\u00e9finie sur le moteur d\u2019affichage. Il permet par exemple de g\u00e9rer l\u2019affichage des \u00e9l\u00e9ments du menu ou des titres du sommaire dans la langue choisie par l\u2019utilisateur. Il faut donc autant de fichier i18n.xml que de langue(s) d\u00e9finie(s) dans l\u2019\u00e9dition. Exemple d\u2019un fichier i18n en fran\u00e7ais : <!-- Fichier i18n-fr.xml --> <properties> <!-- Menu et sous-menu --> <entry key=\"menu.accueil\">Accueil</entry> <entry key=\"menu.sommaire\">Sommaire</entry> <entry key=\"menu.meta\">Description scientifique</entry> <entry key=\"menu.porte-documents\">Porte-documents</entry> <!-- Sommaire --> <entry key=\"toc.titre\">Recherche par cat\u00e9gories</entry> <entry key=\"toc.ART\">Art - Litt\u00e9rature</entry> <entry key=\"toc.DROIT\">Droit - Formation professionnelle</entry> <entry key=\"toc.ELEVAGE\">\u00c9levage - soins</entry> <entry key=\"toc.EQUITATION\">\u00c9quitation, courses</entry> </properties> Dans la balise entry , l\u2019attribut key contient le terme g\u00e9n\u00e9rique : un seul terme qui se retrouvera dans les diff\u00e9rents fichiers i18n des diff\u00e9rentes langues. En revanche, le texte \u00e0 l\u2019int\u00e9rieur des balises entry change en fonction de la langue d\u00e9finie par l\u2019utilisateur sur MaX. Deux fichiers existent par d\u00e9faut dans le c\u0153ur de MaX, pour des \u00e9ditions en fran\u00e7ais et en anglais : Pour une \u00e9dition en fran\u00e7ais : [projet-]MaX / ui / i18n / i18n-fr.xml Pour une \u00e9dition en anglais : [projet-]MaX / ui / i18n / i18n-en.xml Pour surcharger les fichiers XML, il faut cr\u00e9er un fichier i18n[-langueLocale].xml dans le dossier [projet-]editions / [edition] / ui / i18n (par exemple i18n-fr.xml ou i18n-en.xml ). => Pour chaque nouveau fichier i18n, le pr\u00e9fixe utilis\u00e9 doit correspondre au code ISO alpha-2 de la langue utilis\u00e9e (ici fr et en ). Ces fichiers sont ensuite transform\u00e9s par la feuille XSL i18n.xsl , qui se trouve dans le dossier [projet-]MaX / ui / xsl / core . Pour que les \u00e9l\u00e9ments du i18n soient pris en compte, il est n\u00e9cessaire de cr\u00e9er, dans le dossier fragments de chaque \u00e9dition, un dossier correspondant \u00e0 la langue du i18n (en respectant toujours les codes de la norme ISO ). Par exemple : [projet-]editions / [edition] / fragments / fr pour une \u00e9dition en fran\u00e7ais. Le nom donn\u00e9 \u00e0 ce dossier sera celui accol\u00e9 au nom du fichier i18n.xml . Pour un dossier fragments / en , on aura un fichier ui / i18n / i18n-en.xml . Pour chaque page HTML statique (accueil, contact, bibliographie...), il faudra cr\u00e9er autant de fichiers avec l\u2019extension .frag.html que de langue(s) d\u00e9finie(s). Par exemple, pour une \u00e9dition en fran\u00e7ais et en anglais qui propose une page Contact , on placera un fichier contact.frag.html , r\u00e9dig\u00e9 en fran\u00e7ais, dans le dossier fragments/fr et un fichier contact.frag.html , r\u00e9dig\u00e9 en anglais, dans le dossier fragments/en . graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; edition-->A edition-->B A-->A1 A-->A2 A1-->A3 A2-->A4 B-->B1 B1-->B2 edition[\"projet-editions/edition\"] A[\"fragments\"] A1[\"fr\"] A2[\"en\"] A3(\"fichiers .frag.html en fran\u00e7ais\") A4(\"fichiers .frag.html en anglais\") B[\"ui\"] B1[i18n] B2(\"fichiers i18n-fr.xml + i18n-en.xml\")","title":"Fonctionnement"},{"location":"i18n.html#modifier-la-langue-a-afficher-par-defaut","text":"Par d\u00e9faut, lors de l\u2019arriv\u00e9e sur le site de l\u2019\u00e9dition, MaX affiche le contenu du fichier i18n-fr.xml , et les fragments du dossier fragments/fr . Pour modifier ce comportement et afficher une autre langue par d\u00e9faut, il faut ajouter le param\u00e8tre @lang au fichier de configuration [mon-edition]_config-inc.xml , dans le dossier [projet-]editions/[mon-edition] . Par exemple, pour une version par d\u00e9faut en anglais : <edition xml:id=\"mon-edition\" dbpath=\"monedition\" env=\"ead\" prettyName=\"My edition in EAD\" lang=\"en\"> La valeur de l\u2019attribut @lang doit correspondre au code ISO de la langue utilis\u00e9e (ici en ), qui sera \u00e9galement le nom du dossier dans le dossier fragments et le pr\u00e9fixe du fichier i18n.xml . Ce param\u00e8tre de l\u2019attribut @lang est facultatif : s\u2019il n\u2019est pas ajout\u00e9, MaX affiche par d\u00e9faut la version en fran\u00e7ais.","title":"Modifier la langue \u00e0 afficher par d\u00e9faut"},{"location":"i18n.html#exemples","text":"","title":"Exemples"},{"location":"i18n.html#definir-laffichage-du-menu","text":"Pour d\u00e9finir l\u2019affichage du menu en fonction de la langue, dans les balises <id> du fichier menu.xml , on d\u00e9clare des termes g\u00e9n\u00e9riques (\"accueil\", \"sommaire\"...). <!-- Exemple d\u2019un fichier menu.xml --> <menu> <entry type=\"main\"> <id>accueil</id> <target>accueil.html</target> </entry> <entry type=\"main\"> <id>sommaire</id> <target>sommaire.html</target> </entry> </menu> Ces termes g\u00e9n\u00e9riques doivent ensuite \u00eatre d\u00e9clar\u00e9s dans les balises <entry> des diff\u00e9rents fichiers i18n.xml , pour d\u00e9finir le texte \u00e0 afficher dans chaque langue. Ce qui donnera dans les deux fichiers i18n.xml , en fran\u00e7ais et en anglais : <!-- Exemple d\u2019un fichier i18n-fr.xml --> <properties> <entry key=\"menu.accueil\">Accueil</entry> <entry key=\"menu.sommaire\">Sommaire</entry> </properties> <!-- Exemple d\u2019un fichier i18n-en.xml --> <properties> <entry key=\"menu.accueil\">Home</entry> <entry key=\"menu.sommaire\">Summary</entry> </properties>","title":"D\u00e9finir l\u2019affichage du menu"},{"location":"i18n.html#definir-laffichage-du-sommaire","text":"Pour d\u00e9finir le titre de la page de sommaire d\u2019une \u00e9dition en fonction de la langue, on d\u00e9clare un terme g\u00e9n\u00e9rique dans une balise <xsl:value-of> , dans le fichier toc.xsl . Par exemple, \" toc.title \". <!-- Exemple d\u2019un fichier toc.xsl --> <xsl:template match=\"/\"> <div id=\"toc\"> <h1> <xsl:value-of select=\"max:i18n($project,'toc.title',$locale)\"/> </h1> </div> </xsl:template> Ce terme g\u00e9n\u00e9rique doit ensuite \u00eatre d\u00e9clar\u00e9 dans une balise <entry> des diff\u00e9rents fichiers i18n.xml. Ce qui donnera dans les deux fichiers i18n.xml , en fran\u00e7ais et en anglais : <!-- Exemple d\u2019un fichier i18n-fr.xml --> <properties> <entry key=\"toc.titre\">Cadre de classement</entry> </properties> <!-- Exemple d\u2019un fichier i18n-en.xml --> <properties> <entry key=\"toc.titre\">File plan</entry> </properties>","title":"D\u00e9finir l\u2019affichage du sommaire"},{"location":"install.html","text":"Installation Pr\u00e9requis Syst\u00e8me d\u2019exploitation linux ou mac OS Java 8+ BaseX 9.2+ Recommandations architecture Pour chaque projet, l\u2019\u00e9diteur aura besoin : d\u2019une application BaseX (.zip) pouvant \u00eatre t\u00e9l\u00e9charg\u00e9e ici , d\u2019une instance de MaX, d\u2019autant d\u2019\u00e9ditions que de corpus \u00e0 traiter diff\u00e9remment du point de vue graphique (sommaire, logos, pages statiques, options d\u2019affichage, etc.). L\u2019organisation recommand\u00e9e est donc la suivante : Un dossier [projet] va contenir : un dossier BaseX : nomm\u00e9 [projet-]BaseX , un dossier MaX : nomm\u00e9 [projet-]MaX , un dossier pour les \u00e9ditions : nomm\u00e9 [projet-]editions . Exemple graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; projet-->A projet-->B projet-->C projet[\"projet\"] A[\"projet-BaseX\"] B[\"projet-MaX\"] C[\"projet-editions\"] Les dossiers seront li\u00e9s les uns aux autres au moyen de liens symboliques* . graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; projet-->A projet-->B projet-->C A-.->B B-.->C projet[\"projet\"] A[\"projet-BaseX\"] B[\"projet-MaX\"] C[\"projet-editions\"] Les dossiers [projet-]BaseX et [projet-]MaX sont finalement communs \u00e0 l\u2019ensemble des projets d\u00e9velopp\u00e9s sur MaX. Apr\u00e8s l\u2019installation, seuls les \u00e9l\u00e9ments du [projet-]editions devront \u00eatre modifi\u00e9s. Proc\u00e9dure 1) En ligne de commande, se placer dans le dossier [projet] cd le/chemin/vers/mon/projet 2) D\u00e9zipper l\u2019application BaseX (apr\u00e8s avoir plac\u00e9 l\u2019archive .zip dans le dossier [projet] ): unzip basex[XX].zip 3) Renommer l\u2019application BaseX mv basex [projet]-BaseX 4) T\u00e9l\u00e9charger le code source de MaX et le d\u00e9zipper dans votre dossier [projet] . 5) Se placer dans le dossier [projet] et renommer le dossier MaX en [projet-]MaX mv MaX [projet]-MaX 6) Initialiser MaX et installer des d\u00e9pendances* En ligne de commande se placer dans le dossier tools de [projet-]MaX . Puis saisir la commande ./max.sh -i . Ce qui donne : cd [projet-]MaX/tools ./max.sh -i => Si vous \u00eates derri\u00e8re un proxy, vous devez configurer l'acc\u00e8s via ce proxy. Vous pouvez le faire \u00e0 partir d'un terminal, avec les commandes suivantes : export HTTP_PROXY=http://\"votre_proxy_ip\":\"son_numero_port\" export HTTPS_PROXY=https://\"votre_proxy_ip\":\"son_numero_port\" => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]BaseX Nota bene : Le terminal est sensible aux majuscules : si vous avez renomm\u00e9 le dossier [projet]-basex sans majuscule \u00e0 basex , attention \u00e0 ne pas en mettre lorsque vous tapez [projet-]basex dans la commande export BASEX_PATH . Ensuite refaire ./max.sh -i . 7) Cr\u00e9er un lien symbolique depuis le dossier webapp de BaseX ( [projet-]BaseX ) pointant vers MaX ( [projet-]MaX ) cd ../../[projet-]BaseX/webapp ln -s ../../[projet-]MaX MaX En faisant un ls -l vous pouvez v\u00e9rifier que votre lien symbolique a bien \u00e9t\u00e9 cr\u00e9\u00e9 : lrwxr-xr-x 1 anne staff 9 11 mar 15:57 max -> ../../MaX 8) Lancer le serveur HTTP de BaseX cd ../bin ./basexhttp & => Pour v\u00e9rifier l\u2019installation, consulter http://localhost:8984/max.html S\u2019il est n\u00e9cessaire de configurer les ports de mani\u00e8re sp\u00e9cifique pour le projet, faire les \u00e9tapes suivantes : 9) Arr\u00eater le serveur HTTP de BaseX s\u2019il est d\u00e9j\u00e0 lanc\u00e9 ./basexhttpstop 10) Modifier des ports START et STOP dans le fichier cach\u00e9 .basex (qui se trouve \u00e0 la racine du dossier [projet-]BaseX ) l. 13 et 14 : changer le port START (par d\u00e9faut 1984 ; par exemple 17000), l. 38 : changer le port STOP (par d\u00e9faut 8985 ; par exemple 17001) 11) Modifier le port dans le fichier jetty.xml qui se trouve dans le dossier webapp > WEB-INF > jetty.xml . l. 13 : changer le contenu de l\u2019\u00e9l\u00e9ment <Set name=\"port\">8984</Set> (par exemple 17002) 12) Relancer le serveur http de BaseX ./basexhttp & => Pour v\u00e9rifier l\u2019installation, consulter http://localhost:[numero-de-port]/max.html , le num\u00e9ro de port \u00e9tant celui que vous avez d\u00e9clar\u00e9 dans le fichier jetty.xml , \u00e0 l\u2019\u00e9tape 11. Par exemple : http://localhost:17002/max.html .","title":"Installation"},{"location":"install.html#installation","text":"","title":"Installation"},{"location":"install.html#prerequis","text":"Syst\u00e8me d\u2019exploitation linux ou mac OS Java 8+ BaseX 9.2+","title":"Pr\u00e9requis"},{"location":"install.html#recommandations-architecture","text":"Pour chaque projet, l\u2019\u00e9diteur aura besoin : d\u2019une application BaseX (.zip) pouvant \u00eatre t\u00e9l\u00e9charg\u00e9e ici , d\u2019une instance de MaX, d\u2019autant d\u2019\u00e9ditions que de corpus \u00e0 traiter diff\u00e9remment du point de vue graphique (sommaire, logos, pages statiques, options d\u2019affichage, etc.). L\u2019organisation recommand\u00e9e est donc la suivante : Un dossier [projet] va contenir : un dossier BaseX : nomm\u00e9 [projet-]BaseX , un dossier MaX : nomm\u00e9 [projet-]MaX , un dossier pour les \u00e9ditions : nomm\u00e9 [projet-]editions .","title":"Recommandations architecture"},{"location":"install.html#exemple","text":"graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; projet-->A projet-->B projet-->C projet[\"projet\"] A[\"projet-BaseX\"] B[\"projet-MaX\"] C[\"projet-editions\"] Les dossiers seront li\u00e9s les uns aux autres au moyen de liens symboliques* . graph LR; classDef default color:#274868, fill:#fff, stroke:#274868; projet-->A projet-->B projet-->C A-.->B B-.->C projet[\"projet\"] A[\"projet-BaseX\"] B[\"projet-MaX\"] C[\"projet-editions\"] Les dossiers [projet-]BaseX et [projet-]MaX sont finalement communs \u00e0 l\u2019ensemble des projets d\u00e9velopp\u00e9s sur MaX. Apr\u00e8s l\u2019installation, seuls les \u00e9l\u00e9ments du [projet-]editions devront \u00eatre modifi\u00e9s.","title":"Exemple"},{"location":"install.html#procedure","text":"1) En ligne de commande, se placer dans le dossier [projet] cd le/chemin/vers/mon/projet 2) D\u00e9zipper l\u2019application BaseX (apr\u00e8s avoir plac\u00e9 l\u2019archive .zip dans le dossier [projet] ): unzip basex[XX].zip 3) Renommer l\u2019application BaseX mv basex [projet]-BaseX 4) T\u00e9l\u00e9charger le code source de MaX et le d\u00e9zipper dans votre dossier [projet] . 5) Se placer dans le dossier [projet] et renommer le dossier MaX en [projet-]MaX mv MaX [projet]-MaX 6) Initialiser MaX et installer des d\u00e9pendances* En ligne de commande se placer dans le dossier tools de [projet-]MaX . Puis saisir la commande ./max.sh -i . Ce qui donne : cd [projet-]MaX/tools ./max.sh -i => Si vous \u00eates derri\u00e8re un proxy, vous devez configurer l'acc\u00e8s via ce proxy. Vous pouvez le faire \u00e0 partir d'un terminal, avec les commandes suivantes : export HTTP_PROXY=http://\"votre_proxy_ip\":\"son_numero_port\" export HTTPS_PROXY=https://\"votre_proxy_ip\":\"son_numero_port\" => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]BaseX Nota bene : Le terminal est sensible aux majuscules : si vous avez renomm\u00e9 le dossier [projet]-basex sans majuscule \u00e0 basex , attention \u00e0 ne pas en mettre lorsque vous tapez [projet-]basex dans la commande export BASEX_PATH . Ensuite refaire ./max.sh -i . 7) Cr\u00e9er un lien symbolique depuis le dossier webapp de BaseX ( [projet-]BaseX ) pointant vers MaX ( [projet-]MaX ) cd ../../[projet-]BaseX/webapp ln -s ../../[projet-]MaX MaX En faisant un ls -l vous pouvez v\u00e9rifier que votre lien symbolique a bien \u00e9t\u00e9 cr\u00e9\u00e9 : lrwxr-xr-x 1 anne staff 9 11 mar 15:57 max -> ../../MaX 8) Lancer le serveur HTTP de BaseX cd ../bin ./basexhttp & => Pour v\u00e9rifier l\u2019installation, consulter http://localhost:8984/max.html S\u2019il est n\u00e9cessaire de configurer les ports de mani\u00e8re sp\u00e9cifique pour le projet, faire les \u00e9tapes suivantes : 9) Arr\u00eater le serveur HTTP de BaseX s\u2019il est d\u00e9j\u00e0 lanc\u00e9 ./basexhttpstop 10) Modifier des ports START et STOP dans le fichier cach\u00e9 .basex (qui se trouve \u00e0 la racine du dossier [projet-]BaseX ) l. 13 et 14 : changer le port START (par d\u00e9faut 1984 ; par exemple 17000), l. 38 : changer le port STOP (par d\u00e9faut 8985 ; par exemple 17001) 11) Modifier le port dans le fichier jetty.xml qui se trouve dans le dossier webapp > WEB-INF > jetty.xml . l. 13 : changer le contenu de l\u2019\u00e9l\u00e9ment <Set name=\"port\">8984</Set> (par exemple 17002) 12) Relancer le serveur http de BaseX ./basexhttp & => Pour v\u00e9rifier l\u2019installation, consulter http://localhost:[numero-de-port]/max.html , le num\u00e9ro de port \u00e9tant celui que vous avez d\u00e9clar\u00e9 dans le fichier jetty.xml , \u00e0 l\u2019\u00e9tape 11. Par exemple : http://localhost:17002/max.html .","title":"Proc\u00e9dure"},{"location":"layout.html","text":"Gabarits, mise en page Mise en page Le template de mise en page par d\u00e9faut se trouve dans : pour la TEI : [projet-]MaX / ui / templates / tei.html pour l\u2019EAD : [projet-]MaX / ui / templates / ead.html Il est possible de remplacer cette mise en page en cr\u00e9ant son propre template. Pour cela, on ajoute un fichier nomm\u00e9 template.html dans le dossier [projet-]editions / [edition] / ui / templates . Le template contient des r\u00e9f\u00e9rences \u00e0 des variables qui seront remplac\u00e9es par le contenu correspondant \u00e0 l\u2019affichage. Les variables disponibles sont : $projectId : identifiant de l\u2019\u00e9dition, $prettyName : le titre de l\u2019\u00e9dition (tel qu\u2019il doit s\u2019afficher), $baseURI : valeur de la variable de configuration baseURI , $home : le lien vers la page d\u2019accueil du site, $menu : le menu de l\u2019\u00e9dition, $navigationSelect : la barre de navigation de l\u2019\u00e9dition, $textOptions : le s\u00e9lectionneur d\u2019 options de lecture , $head : les d\u00e9clarations d\u2019import de css et les m\u00e9tadonn\u00e9es \u00e0 placer dans le header html, $content : le contenu de la page \u00e0 afficher (document, fragment, sommaire\u2026), $footer : le pied de page de l\u2019\u00e9dition, $jsImports : les d\u00e9clarations des variables et des imports de script js. Il peut \u00eatre \u00e9galement pratique, dans certains cas, de faire r\u00e9f\u00e9rence \u00e0 un template autrement nomm\u00e9 ou qui se trouve dans une autre \u00e9dition. Dans ce cas, il est possible d\u2019ajouter dans mon-edition_config_inc.xml un \u00e9l\u00e9ment : <template file=\"une-autre-edition/ui/templates/template.html\"/> <!-- Exemple de fichier template.html --> <!DOCTYPE html> <html> <head> <meta charset=\"UTF-8\"/> <link rel=\"stylesheet\" href=\"{$baseURI}core/ui/lib/bootstrap.min.css\"/> <link rel=\"stylesheet\" type=\"text/css\" href=\"{$baseURI}core/ui/css/tei.css\"/> {$head} </head> <body> <header id=\"topbar\" class=\"navbar fixed-top navbar-light bg-light\"> <a class=\"navbar-brand\" href=\"{$home}\"> {$prettyName} </a> <div id=\"menu\"> {$menu} </div> <div id=\"navigation-wrap\"> {$navigationSelect} </div> <div> {$textOptions} </div> </header> <div id=\"main-max-container\"> {$content} </div> <!-- footer --> {$footer} <!-- js imports --> <script type=\"text/javascript\" src=\"{$baseURI}core/ui/lib/bootstrap.bundle.min.js\"/> <script type=\"module\" src=\"{$baseURI}core/ui/js/MaxTEI.js\"/> {$jsImports} </body> </html> Voir la section Surchages, Mise en page","title":"Gabarits, mise en page"},{"location":"layout.html#gabarits-mise-en-page","text":"","title":"Gabarits, mise en page"},{"location":"layout.html#mise-en-page","text":"Le template de mise en page par d\u00e9faut se trouve dans : pour la TEI : [projet-]MaX / ui / templates / tei.html pour l\u2019EAD : [projet-]MaX / ui / templates / ead.html Il est possible de remplacer cette mise en page en cr\u00e9ant son propre template. Pour cela, on ajoute un fichier nomm\u00e9 template.html dans le dossier [projet-]editions / [edition] / ui / templates . Le template contient des r\u00e9f\u00e9rences \u00e0 des variables qui seront remplac\u00e9es par le contenu correspondant \u00e0 l\u2019affichage. Les variables disponibles sont : $projectId : identifiant de l\u2019\u00e9dition, $prettyName : le titre de l\u2019\u00e9dition (tel qu\u2019il doit s\u2019afficher), $baseURI : valeur de la variable de configuration baseURI , $home : le lien vers la page d\u2019accueil du site, $menu : le menu de l\u2019\u00e9dition, $navigationSelect : la barre de navigation de l\u2019\u00e9dition, $textOptions : le s\u00e9lectionneur d\u2019 options de lecture , $head : les d\u00e9clarations d\u2019import de css et les m\u00e9tadonn\u00e9es \u00e0 placer dans le header html, $content : le contenu de la page \u00e0 afficher (document, fragment, sommaire\u2026), $footer : le pied de page de l\u2019\u00e9dition, $jsImports : les d\u00e9clarations des variables et des imports de script js. Il peut \u00eatre \u00e9galement pratique, dans certains cas, de faire r\u00e9f\u00e9rence \u00e0 un template autrement nomm\u00e9 ou qui se trouve dans une autre \u00e9dition. Dans ce cas, il est possible d\u2019ajouter dans mon-edition_config_inc.xml un \u00e9l\u00e9ment : <template file=\"une-autre-edition/ui/templates/template.html\"/> <!-- Exemple de fichier template.html --> <!DOCTYPE html> <html> <head> <meta charset=\"UTF-8\"/> <link rel=\"stylesheet\" href=\"{$baseURI}core/ui/lib/bootstrap.min.css\"/> <link rel=\"stylesheet\" type=\"text/css\" href=\"{$baseURI}core/ui/css/tei.css\"/> {$head} </head> <body> <header id=\"topbar\" class=\"navbar fixed-top navbar-light bg-light\"> <a class=\"navbar-brand\" href=\"{$home}\"> {$prettyName} </a> <div id=\"menu\"> {$menu} </div> <div id=\"navigation-wrap\"> {$navigationSelect} </div> <div> {$textOptions} </div> </header> <div id=\"main-max-container\"> {$content} </div> <!-- footer --> {$footer} <!-- js imports --> <script type=\"text/javascript\" src=\"{$baseURI}core/ui/lib/bootstrap.bundle.min.js\"/> <script type=\"module\" src=\"{$baseURI}core/ui/js/MaxTEI.js\"/> {$jsImports} </body> </html> Voir la section Surchages, Mise en page","title":"Mise en page"},{"location":"menu.html","text":"Menu Le fichier menu.xml Les diff\u00e9rents onglets et sous-onglets d\u2019une \u00e9dition se configurent dans le fichier menu.xml qui est g\u00e9n\u00e9r\u00e9, d\u00e8s la cr\u00e9ation d\u2019une \u00e9dition avec l\u2019outil max.sh , dans le dossier [projet-]editions / [edition] (cf. D\u00e9ploiement d\u2019une nouvelle \u00e9dition ). graph LR; A-->B B-->D A[\"projet-editions\"] B[\"mon-edition\"] D(\"menu.xml\") Ce fichier menu.xml permet d\u2019ajouter autant d\u2019onglets et sous-onglets qu\u2019il est n\u00e9cessaire. Ce fichier, dont l\u2019\u00e9l\u00e9ment racine est <menu> , contient un ou plusieurs \u00e9l\u00e9ments <entry> , correspondant \u00e0 autant d\u2019onglets ou de sous-onglets. L\u2019\u00e9l\u00e9ment <entry> contient un \u00e9l\u00e9ment <id> pour indiquer l\u2019identifiant et un \u00e9l\u00e9ment <target> pour mentionner la cible, \u00e0 savoir la fin de l\u2019URL nom.html . Il peut contenir l\u2019attribut @type avec la valeur main , pour d\u00e9signer chaque entr\u00e9e principale. L\u2019\u00e9l\u00e9ment <id> peut \u00eatre sp\u00e9cifi\u00e9 dans le fichier i18n . L\u2019\u00e9l\u00e9ment <target> permet tout aussi bien de pointer vers : - une page HTML statique (voir Pages statiques ), - une URL de consultation sp\u00e9cifique, appel\u00e9e \u00e9galement route* , qui d\u00e9clenche une fonction Xquery ( voir Fonctionnement ), - un lien externe. Dans l\u2019exemple ci-dessous, le menu contient deux entr\u00e9es principales (attribut @type=\"main\" ) : accueil et sommaire . accueil.html pointe (g\u00e9n\u00e9ralement) vers le fragment HTML statique accueil.frag.html (cf. supra ) ; sommaire.html pointe vers la route qui permet de g\u00e9n\u00e9rer le sommaire d\u2019un document (cf. supra ). <menu> <entry type=\"main\"> <id>accueil</id> <target>accueil.html</target> </entry> <entry type=\"main\"> <id>sommaire</id> <target>sommaire.html</target> </entry> </menu> Pour cr\u00e9er des sous-entr\u00e9es (sous-menus) au sein de l\u2019\u00e9l\u00e9ment <entry type=\"main\"> , un ou plusieurs \u00e9l\u00e9ments <entry> sont ajout\u00e9s : chacun poss\u00e8de un identifiant \u2013 \u00e9l\u00e9ment <id> \u2013 ainsi qu\u2019une cible \u2013 \u00e9l\u00e9ment <target> . Dans l\u2019exemple ci-contre, le menu contient deux entr\u00e9es principales accueil et sommaire . L\u2019entr\u00e9e accueil pointe vers l\u2019URL http://[host]:[port]/[edition]/accueil.html et contient deux sous-entr\u00e9es introduction_oeuvre et presentation_oeuvre dont les URL sont respectivement : http://[host]:[port]/[edition]/introduction_oeuvre.html , http://[host]:[port]/[edition]/presentation_oeuvre.html . Ces pages HTML ( introduction_oeuvre.html et presentation_oeuvre.html ) pourront \u00eatre cr\u00e9\u00e9es en suivant la documentation Pages statiques . L\u2019entr\u00e9e sommaire pointe vers l\u2019URL http://[host]:[port]/[edition]/sommaire.html . <menu> <entry type=\"main\" default=\"true\"> <id>home</id> <target>accueil.html</target> <!--Sous-entr\u00e9es pour accueil--> <entry> <id>introduction_oeuvre</id> <target>introduction_oeuvre.html</target> </entry> <entry> <id>presentation_oeuvre</id> <target>presentation_oeuvre.html</target> </entry> <!--Fin Sous-entr\u00e9es pour accueil--> </entry> <entry type=\"main\"> <id>sommaire</id> <target>sommaire.html</target> </entry> </menu> L\u2019affichage du texte du menu est g\u00e9r\u00e9 par un fichier de ressources d\u2019internationalisation (appel\u00e9 i18n* ), qui permettra \u00e0 termes de g\u00e9rer l\u2019adaptation de l\u2019interface \u00e0 des langues diff\u00e9rentes. Voir le fichier i18n . Ce fichier par d\u00e9faut se trouve dans [projet-]MaX / ui / i18n / i18n.xml . Il peut \u00eatre surcharg\u00e9 (cf. infra ). Modification de la mise en forme du menu Le menu HTML est le r\u00e9sultat de la transformation du fichier [projet-]edition / menu.xml par la feuille XSL par d\u00e9faut plac\u00e9e dans [projet-]MaX / ui / xsl / core / menu.xsl . Une feuille de transformation, plac\u00e9e dans le dossier mon-edition / ui / xsl / core / menu.xsl , peut remplacer celle disponible par d\u00e9faut. Trois param\u00e8tres sont disponibles dans cette XSL : baseURI : baseURI du projet, selectedTarget : entr\u00e9e de menu courante (valeur d\u2019un des attributs @target).` projectId : identifiant de l\u2019\u00e9dition, Menu \u00e0 gauche Pour configurer un menu \u00e0 gauche dans la version de d\u00e9monstration max_tei_demo , il est n\u00e9cessaire d\u2019activer la surcharge de transformation du menu en renommant le fichier editions / max_tei_demo / ui / xsl / core / menu_left.xsl en editions / max_tei_demo / ui / xsl / core / menu.xsl . Faire de m\u00eame avec le template HTML, en renommant le fichier editions / max_tei_demo / ui / templates / template_left.html en editions / max_tei_demo / ui / templates / template.html . Lire la section surcharges .","title":"Menu"},{"location":"menu.html#menu","text":"","title":"Menu"},{"location":"menu.html#le-fichier-menuxml","text":"Les diff\u00e9rents onglets et sous-onglets d\u2019une \u00e9dition se configurent dans le fichier menu.xml qui est g\u00e9n\u00e9r\u00e9, d\u00e8s la cr\u00e9ation d\u2019une \u00e9dition avec l\u2019outil max.sh , dans le dossier [projet-]editions / [edition] (cf. D\u00e9ploiement d\u2019une nouvelle \u00e9dition ). graph LR; A-->B B-->D A[\"projet-editions\"] B[\"mon-edition\"] D(\"menu.xml\") Ce fichier menu.xml permet d\u2019ajouter autant d\u2019onglets et sous-onglets qu\u2019il est n\u00e9cessaire. Ce fichier, dont l\u2019\u00e9l\u00e9ment racine est <menu> , contient un ou plusieurs \u00e9l\u00e9ments <entry> , correspondant \u00e0 autant d\u2019onglets ou de sous-onglets. L\u2019\u00e9l\u00e9ment <entry> contient un \u00e9l\u00e9ment <id> pour indiquer l\u2019identifiant et un \u00e9l\u00e9ment <target> pour mentionner la cible, \u00e0 savoir la fin de l\u2019URL nom.html . Il peut contenir l\u2019attribut @type avec la valeur main , pour d\u00e9signer chaque entr\u00e9e principale. L\u2019\u00e9l\u00e9ment <id> peut \u00eatre sp\u00e9cifi\u00e9 dans le fichier i18n . L\u2019\u00e9l\u00e9ment <target> permet tout aussi bien de pointer vers : - une page HTML statique (voir Pages statiques ), - une URL de consultation sp\u00e9cifique, appel\u00e9e \u00e9galement route* , qui d\u00e9clenche une fonction Xquery ( voir Fonctionnement ), - un lien externe. Dans l\u2019exemple ci-dessous, le menu contient deux entr\u00e9es principales (attribut @type=\"main\" ) : accueil et sommaire . accueil.html pointe (g\u00e9n\u00e9ralement) vers le fragment HTML statique accueil.frag.html (cf. supra ) ; sommaire.html pointe vers la route qui permet de g\u00e9n\u00e9rer le sommaire d\u2019un document (cf. supra ). <menu> <entry type=\"main\"> <id>accueil</id> <target>accueil.html</target> </entry> <entry type=\"main\"> <id>sommaire</id> <target>sommaire.html</target> </entry> </menu> Pour cr\u00e9er des sous-entr\u00e9es (sous-menus) au sein de l\u2019\u00e9l\u00e9ment <entry type=\"main\"> , un ou plusieurs \u00e9l\u00e9ments <entry> sont ajout\u00e9s : chacun poss\u00e8de un identifiant \u2013 \u00e9l\u00e9ment <id> \u2013 ainsi qu\u2019une cible \u2013 \u00e9l\u00e9ment <target> . Dans l\u2019exemple ci-contre, le menu contient deux entr\u00e9es principales accueil et sommaire . L\u2019entr\u00e9e accueil pointe vers l\u2019URL http://[host]:[port]/[edition]/accueil.html et contient deux sous-entr\u00e9es introduction_oeuvre et presentation_oeuvre dont les URL sont respectivement : http://[host]:[port]/[edition]/introduction_oeuvre.html , http://[host]:[port]/[edition]/presentation_oeuvre.html . Ces pages HTML ( introduction_oeuvre.html et presentation_oeuvre.html ) pourront \u00eatre cr\u00e9\u00e9es en suivant la documentation Pages statiques . L\u2019entr\u00e9e sommaire pointe vers l\u2019URL http://[host]:[port]/[edition]/sommaire.html . <menu> <entry type=\"main\" default=\"true\"> <id>home</id> <target>accueil.html</target> <!--Sous-entr\u00e9es pour accueil--> <entry> <id>introduction_oeuvre</id> <target>introduction_oeuvre.html</target> </entry> <entry> <id>presentation_oeuvre</id> <target>presentation_oeuvre.html</target> </entry> <!--Fin Sous-entr\u00e9es pour accueil--> </entry> <entry type=\"main\"> <id>sommaire</id> <target>sommaire.html</target> </entry> </menu> L\u2019affichage du texte du menu est g\u00e9r\u00e9 par un fichier de ressources d\u2019internationalisation (appel\u00e9 i18n* ), qui permettra \u00e0 termes de g\u00e9rer l\u2019adaptation de l\u2019interface \u00e0 des langues diff\u00e9rentes. Voir le fichier i18n . Ce fichier par d\u00e9faut se trouve dans [projet-]MaX / ui / i18n / i18n.xml . Il peut \u00eatre surcharg\u00e9 (cf. infra ).","title":"Le fichier menu.xml"},{"location":"menu.html#modification-de-la-mise-en-forme-du-menu","text":"Le menu HTML est le r\u00e9sultat de la transformation du fichier [projet-]edition / menu.xml par la feuille XSL par d\u00e9faut plac\u00e9e dans [projet-]MaX / ui / xsl / core / menu.xsl . Une feuille de transformation, plac\u00e9e dans le dossier mon-edition / ui / xsl / core / menu.xsl , peut remplacer celle disponible par d\u00e9faut. Trois param\u00e8tres sont disponibles dans cette XSL : baseURI : baseURI du projet, selectedTarget : entr\u00e9e de menu courante (valeur d\u2019un des attributs @target).` projectId : identifiant de l\u2019\u00e9dition,","title":"Modification de la mise en forme du menu"},{"location":"menu.html#menu-a-gauche","text":"Pour configurer un menu \u00e0 gauche dans la version de d\u00e9monstration max_tei_demo , il est n\u00e9cessaire d\u2019activer la surcharge de transformation du menu en renommant le fichier editions / max_tei_demo / ui / xsl / core / menu_left.xsl en editions / max_tei_demo / ui / xsl / core / menu.xsl . Faire de m\u00eame avec le template HTML, en renommant le fichier editions / max_tei_demo / ui / templates / template_left.html en editions / max_tei_demo / ui / templates / template.html . Lire la section surcharges .","title":"Menu \u00e0 gauche"},{"location":"metadata.html","text":"M\u00e9tadonn\u00e9es HTML Le contenu des m\u00e9tadonn\u00e9es d\u2019une \u00e9dition est modifiable en cr\u00e9ant un fichier [projet-]editions / [edition] / xq / metadata.xq . Cette XQuery re\u00e7oit 3 param\u00e8tres : $project : l\u2019identifiant de l\u2019\u00e9dition, $requestPath : le chemin de l\u2019URL en cours de consultation, $content : le fragment XML en cours de consultation. Exemple d\u2019une telle XQuery (comportement par d\u00e9faut de MaX) : import module namespace max.html = 'pddn/max/html' at '../../../rxq/html.xqm'; import module namespace max.config = 'pddn/max/config' at '../../../rxq/config.xqm'; declare variable $project external; declare variable $requestPath external; declare variable $content external; <title>{max.html:cleanValue(string-join(($content//(*:h3 | *:h2 | *:h1)[1])//text(), ''))}</title>, <meta name=\"author\" content=\"{max.config:getProjectAuthor($project)}\"/>, <meta property=\"dc:description\" content=\"{max.config:getProjectDescription($project)}\"/>, <meta property=\"dc:title\" content=\"{max.html:cleanValue(string-join(($content//(*:h3 | *:h2 | *:h1)[1])//text(), ''))}\"/>, <meta property=\"dc:type\" content=\"Web page\"/>, <meta property=\"dc:relation\" content=\"{$requestPath}\"/>, <meta property=\"og:description\" content=\"{max.config:getProjectDescription($project)}\"/>, <meta property=\"og:title\" content=\"{max.html:cleanValue(string-join(($content//(*:h3 | *:h2 | *:h1)[1])//text(), ''))}\"/>, <meta property=\"og:type\" content=\"page\"/>, <meta property=\"og:url\" content=\"{$requestPath}\"/>","title":"M\u00e9tadonn\u00e9es HTML"},{"location":"metadata.html#metadonnees-html","text":"Le contenu des m\u00e9tadonn\u00e9es d\u2019une \u00e9dition est modifiable en cr\u00e9ant un fichier [projet-]editions / [edition] / xq / metadata.xq . Cette XQuery re\u00e7oit 3 param\u00e8tres : $project : l\u2019identifiant de l\u2019\u00e9dition, $requestPath : le chemin de l\u2019URL en cours de consultation, $content : le fragment XML en cours de consultation. Exemple d\u2019une telle XQuery (comportement par d\u00e9faut de MaX) : import module namespace max.html = 'pddn/max/html' at '../../../rxq/html.xqm'; import module namespace max.config = 'pddn/max/config' at '../../../rxq/config.xqm'; declare variable $project external; declare variable $requestPath external; declare variable $content external; <title>{max.html:cleanValue(string-join(($content//(*:h3 | *:h2 | *:h1)[1])//text(), ''))}</title>, <meta name=\"author\" content=\"{max.config:getProjectAuthor($project)}\"/>, <meta property=\"dc:description\" content=\"{max.config:getProjectDescription($project)}\"/>, <meta property=\"dc:title\" content=\"{max.html:cleanValue(string-join(($content//(*:h3 | *:h2 | *:h1)[1])//text(), ''))}\"/>, <meta property=\"dc:type\" content=\"Web page\"/>, <meta property=\"dc:relation\" content=\"{$requestPath}\"/>, <meta property=\"og:description\" content=\"{max.config:getProjectDescription($project)}\"/>, <meta property=\"og:title\" content=\"{max.html:cleanValue(string-join(($content//(*:h3 | *:h2 | *:h1)[1])//text(), ''))}\"/>, <meta property=\"og:type\" content=\"page\"/>, <meta property=\"og:url\" content=\"{$requestPath}\"/>","title":"M\u00e9tadonn\u00e9es HTML"},{"location":"overriding.html","text":"Surcharges Les surcharges permettent de modifier le comportement par d\u00e9faut de MaX. Dans certains contextes d\u2019affichage, le contr\u00f4leur* de MaX va v\u00e9rifier si les fichiers xsl et xq existent dans le dossier [projet-]editions/[edition]/[ui ou xq] . Si tel est le cas il va les appliquer, sinon il va utiliser le fichier par d\u00e9faut du c\u0153ur de MaX (dossier [projet-]MaX/[ui ou rxq] ). Ainsi pour modifier le comportement d\u2019un fichier qui se trouve dans le c\u0153ur de MaX ( [projet-]MaX ), il faut le copier et le coller dans le dossier [projet-]editions/[edition] . C\u2019est donc ce fichier que l\u2019on modifiera et qui permettra de faire une surcharge* . Accueil \u00c9diter le fichier [projet-]editions / [edition] / fragments / accueil.frag.html pour modifier la page d\u2019accueil d\u2019une \u00e9dition. Voir Page d\u2019accueil Menu Le menu HTML est le r\u00e9sultat de la transformation du fichier [projet-]editions/[edition] / menu.xml par la feuille XSL par d\u00e9faut, menu.xsl , plac\u00e9e dans [projet]-MaX / ui / xsl / core . Il est possible de modifier ce comportement par d\u00e9faut, en cr\u00e9ant une XSL nomm\u00e9e menu.xsl , plac\u00e9e dans le dossier [projet-]editions / [edition] / ui / xsl / core . Trois param\u00e8tres sont disponibles dans cette XSL : projectId : identifiant du projet, baseURI : baseURI du projet, selectedTarget : entr\u00e9e de menu courante (valeur d\u2019un des attributs @target). Voir Menu Sommaires Sommaire d\u2019une \u00e9dition Pour modifier le sommaire d\u2019une \u00e9dition, il est possible de : modifier la XQuery, en cr\u00e9ant un fichier toc.xq dans le dossier [projet-]editions/[edition]/xq ; modifier la XSL nomm\u00e9e toc.xsl transformant ces \u00e9l\u00e9ments au format HTML dans le dossier [projet-]editions/[edition]/ui/xsl/core . Voir Sommaire d\u2019une \u00e9dition Sommaire d\u2019un document Pour modifier le comportement par d\u00e9faut de la cr\u00e9ation du sommaire d\u2019un document, il est possible de : modifier la XQuery, en cr\u00e9ant un fichier document_toc.xq dans le dossier [projet-]editions/[edition]/xq ; modifier la XSL transformant ces \u00e9l\u00e9ments au format HTML, en cr\u00e9ant un fichier nomm\u00e9 document_toc.xsl plac\u00e9 dans le dossier [projet-]editions/[edition]/ui/xsl/[ead ou tei] . Voir Sommaire d\u2019un document Texte Pour modifier l\u2019affichage par d\u00e9faut des \u00e9l\u00e9ments de votre fichier XML, il faut cr\u00e9er une XSL appel\u00e9e text_hook.xsl , plac\u00e9e dans le dossier [projet-]editions/[edition]/ui/xsl/[ead ou tei] . Voir Textes Barre de navigation Le comportement par d\u00e9faut de la barre de navigation est g\u00e9r\u00e9 par le fichier nav_bar.xsl , plac\u00e9 dans le dossier [projet-]MaX/ui/xsl/tei . On peut surcharger cette feuille de transformation en cr\u00e9ant un fichier nav_bar.xsl , plac\u00e9 dans le dossier [projet-]editions / [edition] / ui / xsl / tei . Voir Texte, Barre de navigation . Mise en page Le template de mise en page par d\u00e9faut se trouve dans [projet-]MaX / ui / templates / [tei ou ead].html . Il est possible de remplacer cette mise en page en cr\u00e9ant son propre template. Pour cela, on ajoute un fichier nomm\u00e9 template.html dans le dossier [projet-]editions / [edition] / ui / templates . Voir Gabarits, mise en page M\u00e9tadonn\u00e9es HTML Le contenu des m\u00e9tadonn\u00e9es d\u2019une \u00e9dition est modifiable en cr\u00e9ant un fichier metadata.xq dans le dossier [projet-]editions / [edition] / xq . Voir M\u00e9tadonn\u00e9es HTML","title":"Surcharges"},{"location":"overriding.html#surcharges","text":"Les surcharges permettent de modifier le comportement par d\u00e9faut de MaX. Dans certains contextes d\u2019affichage, le contr\u00f4leur* de MaX va v\u00e9rifier si les fichiers xsl et xq existent dans le dossier [projet-]editions/[edition]/[ui ou xq] . Si tel est le cas il va les appliquer, sinon il va utiliser le fichier par d\u00e9faut du c\u0153ur de MaX (dossier [projet-]MaX/[ui ou rxq] ). Ainsi pour modifier le comportement d\u2019un fichier qui se trouve dans le c\u0153ur de MaX ( [projet-]MaX ), il faut le copier et le coller dans le dossier [projet-]editions/[edition] . C\u2019est donc ce fichier que l\u2019on modifiera et qui permettra de faire une surcharge* .","title":"Surcharges"},{"location":"overriding.html#accueil","text":"\u00c9diter le fichier [projet-]editions / [edition] / fragments / accueil.frag.html pour modifier la page d\u2019accueil d\u2019une \u00e9dition. Voir Page d\u2019accueil","title":"Accueil"},{"location":"overriding.html#menu","text":"Le menu HTML est le r\u00e9sultat de la transformation du fichier [projet-]editions/[edition] / menu.xml par la feuille XSL par d\u00e9faut, menu.xsl , plac\u00e9e dans [projet]-MaX / ui / xsl / core . Il est possible de modifier ce comportement par d\u00e9faut, en cr\u00e9ant une XSL nomm\u00e9e menu.xsl , plac\u00e9e dans le dossier [projet-]editions / [edition] / ui / xsl / core . Trois param\u00e8tres sont disponibles dans cette XSL : projectId : identifiant du projet, baseURI : baseURI du projet, selectedTarget : entr\u00e9e de menu courante (valeur d\u2019un des attributs @target). Voir Menu","title":"Menu"},{"location":"overriding.html#sommaires","text":"","title":"Sommaires"},{"location":"overriding.html#sommaire-dune-edition","text":"Pour modifier le sommaire d\u2019une \u00e9dition, il est possible de : modifier la XQuery, en cr\u00e9ant un fichier toc.xq dans le dossier [projet-]editions/[edition]/xq ; modifier la XSL nomm\u00e9e toc.xsl transformant ces \u00e9l\u00e9ments au format HTML dans le dossier [projet-]editions/[edition]/ui/xsl/core . Voir Sommaire d\u2019une \u00e9dition","title":"Sommaire d\u2019une \u00e9dition"},{"location":"overriding.html#sommaire-dun-document","text":"Pour modifier le comportement par d\u00e9faut de la cr\u00e9ation du sommaire d\u2019un document, il est possible de : modifier la XQuery, en cr\u00e9ant un fichier document_toc.xq dans le dossier [projet-]editions/[edition]/xq ; modifier la XSL transformant ces \u00e9l\u00e9ments au format HTML, en cr\u00e9ant un fichier nomm\u00e9 document_toc.xsl plac\u00e9 dans le dossier [projet-]editions/[edition]/ui/xsl/[ead ou tei] . Voir Sommaire d\u2019un document","title":"Sommaire d\u2019un document"},{"location":"overriding.html#texte","text":"Pour modifier l\u2019affichage par d\u00e9faut des \u00e9l\u00e9ments de votre fichier XML, il faut cr\u00e9er une XSL appel\u00e9e text_hook.xsl , plac\u00e9e dans le dossier [projet-]editions/[edition]/ui/xsl/[ead ou tei] . Voir Textes","title":"Texte"},{"location":"overriding.html#barre-de-navigation","text":"Le comportement par d\u00e9faut de la barre de navigation est g\u00e9r\u00e9 par le fichier nav_bar.xsl , plac\u00e9 dans le dossier [projet-]MaX/ui/xsl/tei . On peut surcharger cette feuille de transformation en cr\u00e9ant un fichier nav_bar.xsl , plac\u00e9 dans le dossier [projet-]editions / [edition] / ui / xsl / tei . Voir Texte, Barre de navigation .","title":"Barre de navigation"},{"location":"overriding.html#mise-en-page","text":"Le template de mise en page par d\u00e9faut se trouve dans [projet-]MaX / ui / templates / [tei ou ead].html . Il est possible de remplacer cette mise en page en cr\u00e9ant son propre template. Pour cela, on ajoute un fichier nomm\u00e9 template.html dans le dossier [projet-]editions / [edition] / ui / templates . Voir Gabarits, mise en page","title":"Mise en page"},{"location":"overriding.html#metadonnees-html","text":"Le contenu des m\u00e9tadonn\u00e9es d\u2019une \u00e9dition est modifiable en cr\u00e9ant un fichier metadata.xq dans le dossier [projet-]editions / [edition] / xq . Voir M\u00e9tadonn\u00e9es HTML","title":"M\u00e9tadonn\u00e9es HTML"},{"location":"plugins.html","text":"Plugins Un plugin est une brique logicielle proposant une fonctionnalit\u00e9 suppl\u00e9mentaire au noyau de l\u2019application MaX. Il est activ\u00e9 (d\u00e9sactiv\u00e9 par d\u00e9faut) pour une ou plusieurs \u00e9ditions num\u00e9riques. Il peut \u00eatre constitu\u00e9 de ressources RestXQ, XSL, Javascript, CSS... MaX propose un ensemble de plugins plac\u00e9s dans le dossier plugins . Le script max.sh permet l\u2019activation/d\u00e9sactivation de ces plugins. Se placer dans le dossier tools : cd le/chemin/vers/le/projet/[projet-]MaX/tools lister les plugins disponibles ./max.sh --list-plugins => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]basex Puis refaire ./max.sh --list-plugins Le terminal affiche alors la liste des plugins disponibles, ceux inutilis\u00e9s et ceux activ\u00e9s. Nota Bene Si certains plugins apparaissent d\u00e9j\u00e0 comme activ\u00e9s (enabled) alors que vous n\u2019avez jamais lanc\u00e9 vous-m\u00eame la proc\u00e9dure d\u2019activation ci-dessous, il est n\u00e9cessaire d\u2019effectuer cette proc\u00e9dure d\u2019activation pour que le plugin fonctionne. Activer un plugin ./max.sh --enable-plugin [plugin_name] [mon-edition] D\u00e9sactiver un plugin ./max.sh --disable-plugin [plugin_name] [mon-edition] Une fois activ\u00e9 via la ligne de commande ./max.sh , le plugin est automatiquement inscrit dans le fichier de configuration de l\u2019\u00e9dition dans laquelle il a \u00e9t\u00e9 autoris\u00e9 : [projet-]editions/[edition] / mon-edition_config_inc.xml . Il se retrouve au sein d\u2019un \u00e9l\u00e9ment <plugin name='plugin_id'/> de la section <plugins/> de ce fichier. Dans chaque \u00e9l\u00e9ment <plugin> , d\u2019\u00e9ventuels param\u00e8tres de configuration du plugin en question pourront \u00eatre sp\u00e9cifi\u00e9s. <plugins> <!-- exemple de l\u2019activation du plugin breadcrumb --> <plugin name=\"breadcrumb\"> <parameters> <parameter key=\"topLabel\" value=\"Sanctoral \u2013 Beata Maria\"/> </parameters> </plugin> </plugins> Fonctionnement des plugins Lors de la consultation d\u2019un fragment, MaX ex\u00e9cute l\u2019ensemble des Xquery des plugins actifs respectant la convention de nommage : plugins / [NOM_PLUGIN] / [NOM_PLUGIN].xq . Par exemple : graph LR; A-->B B-->C A[\"plugins\"] B[\"breadcrumb\"] C(\"breadcrumb.xq\") Chaque XQuery re\u00e7oit en param\u00e8tres d\u2019entr\u00e9e les variables suivantes : $baseURI : valeur de la variable baseURI, $dbPath : nom de la base de donn\u00e9es XML du projet, $project : identifiant du projet, $doc : document consult\u00e9, $id : id consult\u00e9. Les r\u00e9sultats de ces appels sont renvoy\u00e9s dans un n\u0153ud HTML <div class='plugins-wrapper'/> qui pr\u00e9c\u00e8de le contenu \u00ab textuel \u00bb XML transform\u00e9. Pour l\u2019\u00e9dition de d\u00e9monstration par exemple, on obtient : [...] <div class=\"plugins-wrapper\"> <div class=\"apparat-witnesses\"> ...</div> <div id=\"breadcrumb\">...</div> </div> <div id=\"text\"> [...] </div> [...] Les XSL des plugins activ\u00e9s qui respectent la convention de nommage plugins / [NOM_PLUGIN] / [NOM_PLUGIN].xsl sont automatiquement appliqu\u00e9es. Par exemple : graph LR; A-->B B-->C A[\"plugins\"] B[\"breadcrumb\"] C(\"breadcrumb.xsl\") Plugins et d\u00e9pendances Javascript Certains plugins ont des d\u00e9pendances vers des biblioth\u00e8ques javascript (par exemple img_viewer requiert OpenSeadragon ). Ces biblioth\u00e8ques sont incluses dans chacun des plugins. Abr\u00e9viation D\u00e9velopper ou non les abr\u00e9viations (balises tei:ex & tei:am ). <plugin name=\"abreviation\"/> Exemple de texte sans l\u2019option Abr\u00e9viation : Exemple de texte avec l\u2019option Abr\u00e9viation : Ajout Afficher/masquer les interventions, ajouts, suppressions (balises tei:ad & tei:del ), via les options de lecture. <plugin name=\"ajout\"/> Exemple de texte sans l\u2019option Ajout : Exemple de texte avec l\u2019option Ajout (ajouts en orange, suppressions barr\u00e9es en noir) : Apparat critique Affichage des diff\u00e9rents t\u00e9moins restitu\u00e9s par un apparat critique : <plugin name=\"apparat_critique\"/> Une fen\u00eatre proposant l\u2019affichage par t\u00e9moin appara\u00eet si le fichier xml contient les balises <listWit><witness @xml:id> . <!-- dans le fichier xml --> <listWit> <witness n=\"utile\" xml:id=\"V\"> [...] </witness> <witness n=\"utile\" xml:id=\"O\"> [...] </witness> </listWit> Le contenu des diff\u00e9rents t\u00e9moins est ensuite g\u00e9r\u00e9 \u00e0 l\u2019int\u00e9rieur des balises <app> , puis <lem> et <rdg> . <!-- dans le fichier xml --> <app xml:id=\"c\"> <lem wit=\"V\"> La variante que l\u2019on veut garder dans l\u2019affichage par d\u00e9faut </lem> <rdg wit=\"O\"> Une autre variante </rdg> <rdg wit=\"P\"> Une autre variante </rdg> </app> Lors du rendu final, en s\u00e9lectionnant un t\u00e9moin particulier, pour chaque balise app rencontr\u00e9e, ne seront affich\u00e9es que les balises lem ou rdg qui auront pour attribut @wit le nom du t\u00e9moin. Breadcrumb (Fil d\u2019Ariane) Affichage du fil d\u2019Ariane lors de la consultation du texte. Un fil d\u2019ariane (ou breadcrumb en anglais) est une aide \u00e0 la navigation, pour permettre au lecteur de se situer dans le site. Exemple d\u2019un fil d\u2019ariane : Le param\u00e8tre $topLabel permet de configurer le label de la racine du fil d\u2019Ariane. <plugin name=\"breadcrumb\"> <parameters> <parameter key=\"topLabel\" value=\"Sanctoral \u2013 Beata Maria\"/> </parameters> </plugin> Correction Afficher/masquer les erreurs et leurs corrections (balises tei:sic et tei:corr ), via les options de lecture. <plugin name=\"correction\"/> Exemple de texte sans l\u2019option Correction (le contenu de la balise tei:sic est en rouge, avec le terme [ sic ]) : Exemple de texte avec l\u2019option Correction (le contenu de la balise tei:corr est en vert entre crochets) : Diplomatique Plugin rassemblant les plugins abr\u00e9viation (balises tei:ex et tei:am ), correction (balises tei:sic et tei:corr ), et normalisation (balises tei:reg et tei:orig ). <plugin name=\"diplomatique\"/> EAD basket Ce plugin permet d\u2019utiliser le porte-document dans le cadre des \u00e9ditions en EAD. <plugin name=\"ead_basket\"/> Lorsque vous cochez la case (capture d\u2019\u00e9cran ci-dessus), le document est alors enregistr\u00e9 dans le porte-document. Pour voir le contenu du porte-document (capture d\u2019\u00e9cran ci-dessous), cliquer sur le lien \"porte-documents\". EAD to PDF Le fait d\u2019activer ce plugin, d\u00e9clenche l\u2019affichage d\u2019un bouton permettant de g\u00e9n\u00e9rer un pdf dans une \u00e9dition en EAD. <plugin name=\"ead_pdf\"/> L\u2019url permettant d\u2019activer cette fonctionnalit\u00e9 : http://[host]:[port]/[edition]/[document].xml/[id].pdf Par exemple : http://localhost:17002/mon-edition/monFichier.xml/div1.1.pdf EAD metadata Ce plugin permet d\u2019afficher les m\u00e9tadonn\u00e9es d\u2019une \u00e9dition en EAD contenues dans les balises <eadheader> et <archdesc> . <plugin name=\"ead_metadata\"/> Index Permet de g\u00e9n\u00e9rer diff\u00e9rents index pour les documents en EAD : personnes, lieux, documents, etc. <plugin name=\"index\"/> Les index \u00e9tant trop sp\u00e9cifiques pour permettre la mise en place d\u2019un traitement par d\u00e9faut satisfaisant, ce plugin propose donc une route* unique pour chaque index, solution pour syst\u00e9matiser la production des index ainsi que les routes correspondantes. Il permet de limiter les temps de calcul en stockant les fragments html de chaque page d\u2019index. L\u2019URL associ\u00e9e \u00e0 un index est http://[serveur:port]/[projet]/index/[typeindex].html typeindex : valeur choisie par l\u2019utilisateur (par exemple index/lieux.html ou index/personnes.html ). Par exemple : http://localhost:17002/mon-edition/index/lieux.html Cela n\u00e9cessite de cr\u00e9er un dossier index dans les dossiers suivants : [projet-]editions/[projet]/xq [projet-]editions/[projet]/ui/xsl [projet-]editions/[projet]/fragments/[langueLocale] On place dans le dossier xq/index un fichier nomm\u00e9 index_[typeindex].xq qui permettra de g\u00e9n\u00e9rer l\u2019index. Par exemple, pour un index de Lieux, un fichier index_lieux.xq : declare variable $dbPath external; declare variable $project external; declare variable $baseURI external; <index type=\"lieux\"> {for $idx in collection($dbPath)//*:geogname[@normal] | collection($dbPath)//*:corpname[@normal] let $cId := $idx/ancestor::*:c[@id][1]/@id let $baseuridb := substring-after(base-uri($idx), $dbPath) let $cOtherlevel := $idx/ancestor::*:c[1]/@otherlevel let $role := $idx/@role let $initiale := substring($idx/@normal,1,1) let $cUnitid := $idx/ancestor::*:c[1]/descendant::*:unitid[1]/text() let $cParent := $idx/ancestor::*:c[@otherlevel]/descendant::*:unitid[1]/text() let $result := <marker id=\"{$cId}\" otherlevel=\"{$cOtherlevel}\" role=\"{$role}\"> <entry>{$cUnitid}</entry> <manuscrit>{$cParent}</manuscrit> <value>{data($idx/@normal)}</value> <baseuri>{$baseURI || $project || $baseuridb}</baseuri> <initiale>{translate($initiale,'\u00c9[','E')}</initiale> </marker> return $result } </index> Si n\u00e9cessaire, on surcharge avec une XSL dans le dossier ui/xsl/index avec un fichier index_[typeindex].xsl . Lors du premier acc\u00e8s \u00e0 la page [projet]/index/[typeindex].html , un fichier HTML ( index_[typeindex].frag.html ) est g\u00e9n\u00e9r\u00e9 dans le dossier fragments/[langueLocale]/index : la requ\u00eate XQUERY et le traitement XSL associ\u00e9 sont ex\u00e9cut\u00e9s lors de ce premier appel. Pour g\u00e9n\u00e9rer \u00e0 nouveau la page d\u2019index, il faut supprimer le fichier index_[typeindex].frag.html souhait\u00e9, et relancer la page [projet]/index/[typeindex].html . Normalisation Afficher/masquer la normalisation de l\u2019\u00e9diteur (balises tei:reg & tei:orig ), via les options de lecture. <plugin name=\"normalisation\"/> Exemple de texte sans l\u2019option Normalisation : Exemple de texte avec l\u2019option Normalisation : Recherche EAD (ead_search) Voici un exemple de configuration du plugin de recherche : <plugin name=\"ead_search\"> <parameters> <parameter key=\"searchForm\"> <search> <tags> <tag name=\"persname\" attribute=\"role\" value=\"auteur\" label=\"Auteurs\"/> <tag name=\"title\" attribute=\"type\" value=\"Oeuvre\" label=\"Titre des \u0153uvres\"/> <tag name=\"geogname\" attribute=\"role\" value=\"publication\" label=\"Lieux de publication\"/> <tag name=\"corpname\" attribute=\"role\" value=\"scriptorium\" label=\"Scriptoria\"/> </tags> <dates format=\"YYYY\"/> </search> </parameter> </parameters> </plugin> tag : nom de l\u2019\u00e9l\u00e9ment XML dans lequel les recherches sont effectu\u00e9es, avec name pour le nom de la balise, atribute pour l\u2019attribut voulu dans la balise et value pour la valeur de l\u2019attribut. Les balises ead:name vis\u00e9es par la recherche (ici persname, title, geogname, corpname ) doivent absolument poss\u00e9der un attribut @normal dans le document XML pour \u00eatre prises en compte par la recherche. La recherche est accessible \u00e0 cette URL : http://[host]:[port]/[edition]/rechercher.html Recherche TEI (search) Voici un exemple de configuration du plugin de recherche : <plugin name=\"search\"> <parameters> <!--Les recherches sont effectu\u00e9es dans toutes les balises p, app, lem et rdg (et leurs descendants)--> <parameter key=\"tag\" value=\"p app lem rdg\"/> <!--Pour chacun des r\u00e9sultats, le lien de retour au texte pointe vers la div anc\u00eatre identifi\u00e9e ayant un @ type--> <parameter key=\"backToTextID\" value=\"(./ancestor::*:div[@*:type])[1]/@xml:id\"/> </parameters> </plugin> <docsToIgnore> <docToIgnore>monfichier.xml</docToIgnore> </docsToIgnore> value : nom des balises TEI dans lequel les recherches sont effectu\u00e9es, backToTextId : xpath \u00e0 suivre pour les liens de retour au texte sur les \u00e9l\u00e9ments de r\u00e9sultat, docsToIgnore : permet d\u2019indiquer les fichiers que l\u2019on ne souhaite pas prendre en compte pour la recherche. La recherche est accessible \u00e0 cette URL : http://[host]:[port]/[edition]/search.html Side toc (EAD) <plugin name=\"side_toc\"/> Ce plugin doit \u00eatre d\u00e9clar\u00e9 pour les \u00e9ditions en EAD. Il permet de g\u00e9n\u00e9rer un sommaire interactif et arborescent sur la partie gauche du site. Pour modifier l\u2019affichage par d\u00e9faut de la side toc, on peut surcharger son comportement en cr\u00e9ant un fichier nomm\u00e9 document_toc.xq , que l\u2019on place dans le dossier [projet-]editions/[edition]/xq . Sources export Ce plugin permet de r\u00e9cup\u00e9rer l\u2019ensemble des fichiers XML de l\u2019\u00e9dition ( ajout\u00e9s via BaseX ) dans un dossier zipp\u00e9. <plugin name=\"sources_export\"/> Pour r\u00e9cup\u00e9rer le dossier zipp\u00e9, il faut saisir l\u2019url suivante : http://[host]:[port]/[edition]/[edition].zip Par exemple : http://localhost:17002/mon-edition/mon-edition.zip Si un fichier XML est indent\u00e9 lorsqu\u2019il est ajout\u00e9 dans BaseX, le plugin le r\u00e9cup\u00e9rera indent\u00e9 dans le fichier .zip. On peut rajouter des param\u00e8tres dans l\u2019URL pour r\u00e9cup\u00e9rer : Soit l\u2019ensemble des fichiers XML indent\u00e9s : http://[host]:[port]/[edition]/[edition].zip?indent=true Soit l\u2019ensemble des fichiers XML non indent\u00e9s : http://[host]:[port]/[edition]/[edition].zip?indent=no TEI to PDF <plugin name=\"tei_pdf\"/> Le fait d\u2019activer ce plugin, d\u00e9clenche l\u2019affichage d\u2019un bouton permettant de g\u00e9n\u00e9rer un PDF. L\u2019url permettant d\u2019activer cette fonctionnalit\u00e9 : http://[host]:[port]/[edition]/[document].xml/[id].pdf Par exemple : http://localhost:17002/mon-edition/monFichier.xml/div1.1.pdf Nota Bene La g\u00e9n\u00e9ration d\u2019un PDF pour une \u00e9dition align\u00e9e en TEI ne fonctionne pas pour l\u2019instant. Visionneuse d\u2019images (img_viewer) Permet la consultation des images au sein d\u2019une visionneuse ( Openseadragon ). Ce plugin requiert le chemin de stockage des images relatif \u00e0 l\u2019\u00e9dition ( imagesRepository ) comme param\u00e8tre de configuration : <plugin name=\"img_viewer\"> <parameters> <parameter key=\"imagesRepository\" value=\"ui/images/\" xsl=\"true\"/> </parameters> </plugin> Le chemin (ici ui/images ) est indiqu\u00e9 dans l\u2019attribut @value de la balise <parameter> . Pour consulter des images tuil\u00e9es (dzi, iiif, etc.), il faut surcharger le template relatif \u00e0 la balise tei:graphic dans le fichier text_hook.xsl (situ\u00e9 dans le dossier [projet-]editions/[edition]/ui/xsl/[ead ou tei] ). On remplace alors le param\u00e8tre d\u2019appel \u00e0 MAX.plugins['img_viewer'].openImageInDialog par l\u2019URL du .dzi ou .json .","title":"Plugins"},{"location":"plugins.html#plugins","text":"Un plugin est une brique logicielle proposant une fonctionnalit\u00e9 suppl\u00e9mentaire au noyau de l\u2019application MaX. Il est activ\u00e9 (d\u00e9sactiv\u00e9 par d\u00e9faut) pour une ou plusieurs \u00e9ditions num\u00e9riques. Il peut \u00eatre constitu\u00e9 de ressources RestXQ, XSL, Javascript, CSS... MaX propose un ensemble de plugins plac\u00e9s dans le dossier plugins . Le script max.sh permet l\u2019activation/d\u00e9sactivation de ces plugins. Se placer dans le dossier tools : cd le/chemin/vers/le/projet/[projet-]MaX/tools lister les plugins disponibles ./max.sh --list-plugins => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]basex Puis refaire ./max.sh --list-plugins Le terminal affiche alors la liste des plugins disponibles, ceux inutilis\u00e9s et ceux activ\u00e9s. Nota Bene Si certains plugins apparaissent d\u00e9j\u00e0 comme activ\u00e9s (enabled) alors que vous n\u2019avez jamais lanc\u00e9 vous-m\u00eame la proc\u00e9dure d\u2019activation ci-dessous, il est n\u00e9cessaire d\u2019effectuer cette proc\u00e9dure d\u2019activation pour que le plugin fonctionne. Activer un plugin ./max.sh --enable-plugin [plugin_name] [mon-edition] D\u00e9sactiver un plugin ./max.sh --disable-plugin [plugin_name] [mon-edition] Une fois activ\u00e9 via la ligne de commande ./max.sh , le plugin est automatiquement inscrit dans le fichier de configuration de l\u2019\u00e9dition dans laquelle il a \u00e9t\u00e9 autoris\u00e9 : [projet-]editions/[edition] / mon-edition_config_inc.xml . Il se retrouve au sein d\u2019un \u00e9l\u00e9ment <plugin name='plugin_id'/> de la section <plugins/> de ce fichier. Dans chaque \u00e9l\u00e9ment <plugin> , d\u2019\u00e9ventuels param\u00e8tres de configuration du plugin en question pourront \u00eatre sp\u00e9cifi\u00e9s. <plugins> <!-- exemple de l\u2019activation du plugin breadcrumb --> <plugin name=\"breadcrumb\"> <parameters> <parameter key=\"topLabel\" value=\"Sanctoral \u2013 Beata Maria\"/> </parameters> </plugin> </plugins>","title":"Plugins"},{"location":"plugins.html#fonctionnement-des-plugins","text":"Lors de la consultation d\u2019un fragment, MaX ex\u00e9cute l\u2019ensemble des Xquery des plugins actifs respectant la convention de nommage : plugins / [NOM_PLUGIN] / [NOM_PLUGIN].xq . Par exemple : graph LR; A-->B B-->C A[\"plugins\"] B[\"breadcrumb\"] C(\"breadcrumb.xq\") Chaque XQuery re\u00e7oit en param\u00e8tres d\u2019entr\u00e9e les variables suivantes : $baseURI : valeur de la variable baseURI, $dbPath : nom de la base de donn\u00e9es XML du projet, $project : identifiant du projet, $doc : document consult\u00e9, $id : id consult\u00e9. Les r\u00e9sultats de ces appels sont renvoy\u00e9s dans un n\u0153ud HTML <div class='plugins-wrapper'/> qui pr\u00e9c\u00e8de le contenu \u00ab textuel \u00bb XML transform\u00e9. Pour l\u2019\u00e9dition de d\u00e9monstration par exemple, on obtient : [...] <div class=\"plugins-wrapper\"> <div class=\"apparat-witnesses\"> ...</div> <div id=\"breadcrumb\">...</div> </div> <div id=\"text\"> [...] </div> [...] Les XSL des plugins activ\u00e9s qui respectent la convention de nommage plugins / [NOM_PLUGIN] / [NOM_PLUGIN].xsl sont automatiquement appliqu\u00e9es. Par exemple : graph LR; A-->B B-->C A[\"plugins\"] B[\"breadcrumb\"] C(\"breadcrumb.xsl\")","title":"Fonctionnement des plugins"},{"location":"plugins.html#plugins-et-dependances-javascript","text":"Certains plugins ont des d\u00e9pendances vers des biblioth\u00e8ques javascript (par exemple img_viewer requiert OpenSeadragon ). Ces biblioth\u00e8ques sont incluses dans chacun des plugins.","title":"Plugins et d\u00e9pendances Javascript"},{"location":"plugins.html#abreviation","text":"D\u00e9velopper ou non les abr\u00e9viations (balises tei:ex & tei:am ). <plugin name=\"abreviation\"/> Exemple de texte sans l\u2019option Abr\u00e9viation : Exemple de texte avec l\u2019option Abr\u00e9viation :","title":"Abr\u00e9viation"},{"location":"plugins.html#ajout","text":"Afficher/masquer les interventions, ajouts, suppressions (balises tei:ad & tei:del ), via les options de lecture. <plugin name=\"ajout\"/> Exemple de texte sans l\u2019option Ajout : Exemple de texte avec l\u2019option Ajout (ajouts en orange, suppressions barr\u00e9es en noir) :","title":"Ajout"},{"location":"plugins.html#apparat-critique","text":"Affichage des diff\u00e9rents t\u00e9moins restitu\u00e9s par un apparat critique : <plugin name=\"apparat_critique\"/> Une fen\u00eatre proposant l\u2019affichage par t\u00e9moin appara\u00eet si le fichier xml contient les balises <listWit><witness @xml:id> . <!-- dans le fichier xml --> <listWit> <witness n=\"utile\" xml:id=\"V\"> [...] </witness> <witness n=\"utile\" xml:id=\"O\"> [...] </witness> </listWit> Le contenu des diff\u00e9rents t\u00e9moins est ensuite g\u00e9r\u00e9 \u00e0 l\u2019int\u00e9rieur des balises <app> , puis <lem> et <rdg> . <!-- dans le fichier xml --> <app xml:id=\"c\"> <lem wit=\"V\"> La variante que l\u2019on veut garder dans l\u2019affichage par d\u00e9faut </lem> <rdg wit=\"O\"> Une autre variante </rdg> <rdg wit=\"P\"> Une autre variante </rdg> </app> Lors du rendu final, en s\u00e9lectionnant un t\u00e9moin particulier, pour chaque balise app rencontr\u00e9e, ne seront affich\u00e9es que les balises lem ou rdg qui auront pour attribut @wit le nom du t\u00e9moin.","title":"Apparat critique"},{"location":"plugins.html#breadcrumb-fil-dariane","text":"Affichage du fil d\u2019Ariane lors de la consultation du texte. Un fil d\u2019ariane (ou breadcrumb en anglais) est une aide \u00e0 la navigation, pour permettre au lecteur de se situer dans le site. Exemple d\u2019un fil d\u2019ariane : Le param\u00e8tre $topLabel permet de configurer le label de la racine du fil d\u2019Ariane. <plugin name=\"breadcrumb\"> <parameters> <parameter key=\"topLabel\" value=\"Sanctoral \u2013 Beata Maria\"/> </parameters> </plugin>","title":"Breadcrumb (Fil d\u2019Ariane)"},{"location":"plugins.html#correction","text":"Afficher/masquer les erreurs et leurs corrections (balises tei:sic et tei:corr ), via les options de lecture. <plugin name=\"correction\"/> Exemple de texte sans l\u2019option Correction (le contenu de la balise tei:sic est en rouge, avec le terme [ sic ]) : Exemple de texte avec l\u2019option Correction (le contenu de la balise tei:corr est en vert entre crochets) :","title":"Correction"},{"location":"plugins.html#diplomatique","text":"Plugin rassemblant les plugins abr\u00e9viation (balises tei:ex et tei:am ), correction (balises tei:sic et tei:corr ), et normalisation (balises tei:reg et tei:orig ). <plugin name=\"diplomatique\"/>","title":"Diplomatique"},{"location":"plugins.html#ead-basket","text":"Ce plugin permet d\u2019utiliser le porte-document dans le cadre des \u00e9ditions en EAD. <plugin name=\"ead_basket\"/> Lorsque vous cochez la case (capture d\u2019\u00e9cran ci-dessus), le document est alors enregistr\u00e9 dans le porte-document. Pour voir le contenu du porte-document (capture d\u2019\u00e9cran ci-dessous), cliquer sur le lien \"porte-documents\".","title":"EAD basket"},{"location":"plugins.html#ead-to-pdf","text":"Le fait d\u2019activer ce plugin, d\u00e9clenche l\u2019affichage d\u2019un bouton permettant de g\u00e9n\u00e9rer un pdf dans une \u00e9dition en EAD. <plugin name=\"ead_pdf\"/> L\u2019url permettant d\u2019activer cette fonctionnalit\u00e9 : http://[host]:[port]/[edition]/[document].xml/[id].pdf Par exemple : http://localhost:17002/mon-edition/monFichier.xml/div1.1.pdf","title":"EAD to PDF"},{"location":"plugins.html#ead-metadata","text":"Ce plugin permet d\u2019afficher les m\u00e9tadonn\u00e9es d\u2019une \u00e9dition en EAD contenues dans les balises <eadheader> et <archdesc> . <plugin name=\"ead_metadata\"/>","title":"EAD metadata"},{"location":"plugins.html#index","text":"Permet de g\u00e9n\u00e9rer diff\u00e9rents index pour les documents en EAD : personnes, lieux, documents, etc. <plugin name=\"index\"/> Les index \u00e9tant trop sp\u00e9cifiques pour permettre la mise en place d\u2019un traitement par d\u00e9faut satisfaisant, ce plugin propose donc une route* unique pour chaque index, solution pour syst\u00e9matiser la production des index ainsi que les routes correspondantes. Il permet de limiter les temps de calcul en stockant les fragments html de chaque page d\u2019index. L\u2019URL associ\u00e9e \u00e0 un index est http://[serveur:port]/[projet]/index/[typeindex].html typeindex : valeur choisie par l\u2019utilisateur (par exemple index/lieux.html ou index/personnes.html ). Par exemple : http://localhost:17002/mon-edition/index/lieux.html Cela n\u00e9cessite de cr\u00e9er un dossier index dans les dossiers suivants : [projet-]editions/[projet]/xq [projet-]editions/[projet]/ui/xsl [projet-]editions/[projet]/fragments/[langueLocale] On place dans le dossier xq/index un fichier nomm\u00e9 index_[typeindex].xq qui permettra de g\u00e9n\u00e9rer l\u2019index. Par exemple, pour un index de Lieux, un fichier index_lieux.xq : declare variable $dbPath external; declare variable $project external; declare variable $baseURI external; <index type=\"lieux\"> {for $idx in collection($dbPath)//*:geogname[@normal] | collection($dbPath)//*:corpname[@normal] let $cId := $idx/ancestor::*:c[@id][1]/@id let $baseuridb := substring-after(base-uri($idx), $dbPath) let $cOtherlevel := $idx/ancestor::*:c[1]/@otherlevel let $role := $idx/@role let $initiale := substring($idx/@normal,1,1) let $cUnitid := $idx/ancestor::*:c[1]/descendant::*:unitid[1]/text() let $cParent := $idx/ancestor::*:c[@otherlevel]/descendant::*:unitid[1]/text() let $result := <marker id=\"{$cId}\" otherlevel=\"{$cOtherlevel}\" role=\"{$role}\"> <entry>{$cUnitid}</entry> <manuscrit>{$cParent}</manuscrit> <value>{data($idx/@normal)}</value> <baseuri>{$baseURI || $project || $baseuridb}</baseuri> <initiale>{translate($initiale,'\u00c9[','E')}</initiale> </marker> return $result } </index> Si n\u00e9cessaire, on surcharge avec une XSL dans le dossier ui/xsl/index avec un fichier index_[typeindex].xsl . Lors du premier acc\u00e8s \u00e0 la page [projet]/index/[typeindex].html , un fichier HTML ( index_[typeindex].frag.html ) est g\u00e9n\u00e9r\u00e9 dans le dossier fragments/[langueLocale]/index : la requ\u00eate XQUERY et le traitement XSL associ\u00e9 sont ex\u00e9cut\u00e9s lors de ce premier appel. Pour g\u00e9n\u00e9rer \u00e0 nouveau la page d\u2019index, il faut supprimer le fichier index_[typeindex].frag.html souhait\u00e9, et relancer la page [projet]/index/[typeindex].html .","title":"Index"},{"location":"plugins.html#normalisation","text":"Afficher/masquer la normalisation de l\u2019\u00e9diteur (balises tei:reg & tei:orig ), via les options de lecture. <plugin name=\"normalisation\"/> Exemple de texte sans l\u2019option Normalisation : Exemple de texte avec l\u2019option Normalisation :","title":"Normalisation"},{"location":"plugins.html#recherche-ead-ead_search","text":"Voici un exemple de configuration du plugin de recherche : <plugin name=\"ead_search\"> <parameters> <parameter key=\"searchForm\"> <search> <tags> <tag name=\"persname\" attribute=\"role\" value=\"auteur\" label=\"Auteurs\"/> <tag name=\"title\" attribute=\"type\" value=\"Oeuvre\" label=\"Titre des \u0153uvres\"/> <tag name=\"geogname\" attribute=\"role\" value=\"publication\" label=\"Lieux de publication\"/> <tag name=\"corpname\" attribute=\"role\" value=\"scriptorium\" label=\"Scriptoria\"/> </tags> <dates format=\"YYYY\"/> </search> </parameter> </parameters> </plugin> tag : nom de l\u2019\u00e9l\u00e9ment XML dans lequel les recherches sont effectu\u00e9es, avec name pour le nom de la balise, atribute pour l\u2019attribut voulu dans la balise et value pour la valeur de l\u2019attribut. Les balises ead:name vis\u00e9es par la recherche (ici persname, title, geogname, corpname ) doivent absolument poss\u00e9der un attribut @normal dans le document XML pour \u00eatre prises en compte par la recherche. La recherche est accessible \u00e0 cette URL : http://[host]:[port]/[edition]/rechercher.html","title":"Recherche EAD (ead_search)"},{"location":"plugins.html#recherche-tei-search","text":"Voici un exemple de configuration du plugin de recherche : <plugin name=\"search\"> <parameters> <!--Les recherches sont effectu\u00e9es dans toutes les balises p, app, lem et rdg (et leurs descendants)--> <parameter key=\"tag\" value=\"p app lem rdg\"/> <!--Pour chacun des r\u00e9sultats, le lien de retour au texte pointe vers la div anc\u00eatre identifi\u00e9e ayant un @ type--> <parameter key=\"backToTextID\" value=\"(./ancestor::*:div[@*:type])[1]/@xml:id\"/> </parameters> </plugin> <docsToIgnore> <docToIgnore>monfichier.xml</docToIgnore> </docsToIgnore> value : nom des balises TEI dans lequel les recherches sont effectu\u00e9es, backToTextId : xpath \u00e0 suivre pour les liens de retour au texte sur les \u00e9l\u00e9ments de r\u00e9sultat, docsToIgnore : permet d\u2019indiquer les fichiers que l\u2019on ne souhaite pas prendre en compte pour la recherche. La recherche est accessible \u00e0 cette URL : http://[host]:[port]/[edition]/search.html","title":"Recherche TEI (search)"},{"location":"plugins.html#side-toc-ead","text":"<plugin name=\"side_toc\"/> Ce plugin doit \u00eatre d\u00e9clar\u00e9 pour les \u00e9ditions en EAD. Il permet de g\u00e9n\u00e9rer un sommaire interactif et arborescent sur la partie gauche du site. Pour modifier l\u2019affichage par d\u00e9faut de la side toc, on peut surcharger son comportement en cr\u00e9ant un fichier nomm\u00e9 document_toc.xq , que l\u2019on place dans le dossier [projet-]editions/[edition]/xq .","title":"Side toc (EAD)"},{"location":"plugins.html#sources-export","text":"Ce plugin permet de r\u00e9cup\u00e9rer l\u2019ensemble des fichiers XML de l\u2019\u00e9dition ( ajout\u00e9s via BaseX ) dans un dossier zipp\u00e9. <plugin name=\"sources_export\"/> Pour r\u00e9cup\u00e9rer le dossier zipp\u00e9, il faut saisir l\u2019url suivante : http://[host]:[port]/[edition]/[edition].zip Par exemple : http://localhost:17002/mon-edition/mon-edition.zip Si un fichier XML est indent\u00e9 lorsqu\u2019il est ajout\u00e9 dans BaseX, le plugin le r\u00e9cup\u00e9rera indent\u00e9 dans le fichier .zip. On peut rajouter des param\u00e8tres dans l\u2019URL pour r\u00e9cup\u00e9rer : Soit l\u2019ensemble des fichiers XML indent\u00e9s : http://[host]:[port]/[edition]/[edition].zip?indent=true Soit l\u2019ensemble des fichiers XML non indent\u00e9s : http://[host]:[port]/[edition]/[edition].zip?indent=no","title":"Sources export"},{"location":"plugins.html#tei-to-pdf","text":"<plugin name=\"tei_pdf\"/> Le fait d\u2019activer ce plugin, d\u00e9clenche l\u2019affichage d\u2019un bouton permettant de g\u00e9n\u00e9rer un PDF. L\u2019url permettant d\u2019activer cette fonctionnalit\u00e9 : http://[host]:[port]/[edition]/[document].xml/[id].pdf Par exemple : http://localhost:17002/mon-edition/monFichier.xml/div1.1.pdf Nota Bene La g\u00e9n\u00e9ration d\u2019un PDF pour une \u00e9dition align\u00e9e en TEI ne fonctionne pas pour l\u2019instant.","title":"TEI to PDF"},{"location":"plugins.html#visionneuse-dimages-img_viewer","text":"Permet la consultation des images au sein d\u2019une visionneuse ( Openseadragon ). Ce plugin requiert le chemin de stockage des images relatif \u00e0 l\u2019\u00e9dition ( imagesRepository ) comme param\u00e8tre de configuration : <plugin name=\"img_viewer\"> <parameters> <parameter key=\"imagesRepository\" value=\"ui/images/\" xsl=\"true\"/> </parameters> </plugin> Le chemin (ici ui/images ) est indiqu\u00e9 dans l\u2019attribut @value de la balise <parameter> . Pour consulter des images tuil\u00e9es (dzi, iiif, etc.), il faut surcharger le template relatif \u00e0 la balise tei:graphic dans le fichier text_hook.xsl (situ\u00e9 dans le dossier [projet-]editions/[edition]/ui/xsl/[ead ou tei] ). On remplace alors le param\u00e8tre d\u2019appel \u00e0 MAX.plugins['img_viewer'].openImageInDialog par l\u2019URL du .dzi ou .json .","title":"Visionneuse d\u2019images (img_viewer)"},{"location":"production.html","text":"Mise en production Exemple pour une instance MaX d\u00e9ploy\u00e9e en local sur http://localhost:1234/ : La variable baseURI Pour un site d\u00e9ploy\u00e9 sur une URL autre que la racine de l\u2019h\u00f4te, la variable $baseURI doit \u00eatre renseign\u00e9e dans le fichier [projet]-MaX/configuration / configuration.xml . Par exemple, pour un site publi\u00e9 \u00e0 l\u2019adresse https://site.domain.ext/max-demo/ <?xml version=\"1.0\"?> <configuration xmlns:xi=\"http://www.w3.org/2001/XInclude\"> <baseURI>/max-demo/</baseURI> [...] </configuration> Configuration Apache Sur le serveur de production, ajouter les r\u00e8gles de reverse-proxy* permettant de joindre votre instance de MaX disponible localement. Par exemple, pour un MaX actif \u00e0 l\u2019adresse http://localhost:1234 en local : ProxyPass /max-demo/max_tei_demo/ http://127.0.0.1:1234/max_tei_demo/ ProxyPassReverse /max-demo/max_tei_demo/ http://127.0.0.1:1234/max_tei_demo/ ProxyPass /max-demo/plugins/ http://127.0.0.1:1234/plugins/ ProxyPassReverse /max-demo/plugins/ http://127.0.0.1:1234/plugins/ ProxyPass /max-demo/core/ http://127.0.0.1:1234/core/ ProxyPassReverse /max-demo/core/ http://127.0.0.1:1234/core/ La seule r\u00e8gle /max-demo/ vers http://127.0.0.1:1234/ rend l\u2019application d\u2019administration BaseX accessible depuis l\u2019ext\u00e9rieur \u00e0 l\u2019adresse https://site.domain.ext/max-demo/dba/.","title":"Mise en production"},{"location":"production.html#mise-en-production","text":"Exemple pour une instance MaX d\u00e9ploy\u00e9e en local sur http://localhost:1234/ :","title":"Mise en production"},{"location":"production.html#la-variable-baseuri","text":"Pour un site d\u00e9ploy\u00e9 sur une URL autre que la racine de l\u2019h\u00f4te, la variable $baseURI doit \u00eatre renseign\u00e9e dans le fichier [projet]-MaX/configuration / configuration.xml . Par exemple, pour un site publi\u00e9 \u00e0 l\u2019adresse https://site.domain.ext/max-demo/ <?xml version=\"1.0\"?> <configuration xmlns:xi=\"http://www.w3.org/2001/XInclude\"> <baseURI>/max-demo/</baseURI> [...] </configuration>","title":"La variable baseURI"},{"location":"production.html#configuration-apache","text":"Sur le serveur de production, ajouter les r\u00e8gles de reverse-proxy* permettant de joindre votre instance de MaX disponible localement. Par exemple, pour un MaX actif \u00e0 l\u2019adresse http://localhost:1234 en local : ProxyPass /max-demo/max_tei_demo/ http://127.0.0.1:1234/max_tei_demo/ ProxyPassReverse /max-demo/max_tei_demo/ http://127.0.0.1:1234/max_tei_demo/ ProxyPass /max-demo/plugins/ http://127.0.0.1:1234/plugins/ ProxyPassReverse /max-demo/plugins/ http://127.0.0.1:1234/plugins/ ProxyPass /max-demo/core/ http://127.0.0.1:1234/core/ ProxyPassReverse /max-demo/core/ http://127.0.0.1:1234/core/ La seule r\u00e8gle /max-demo/ vers http://127.0.0.1:1234/ rend l\u2019application d\u2019administration BaseX accessible depuis l\u2019ext\u00e9rieur \u00e0 l\u2019adresse https://site.domain.ext/max-demo/dba/.","title":"Configuration Apache"},{"location":"script.html","text":"Cr\u00e9ation d\u2019\u00e9dition Pour cr\u00e9er un site, il faut cr\u00e9er une nouvelle \u00e9dition qui va \u00eatre associ\u00e9e \u00e0 une base de donn\u00e9es XML (BaseX). Le nom de l\u2019\u00e9dition est le nom qui appara\u00eetra dans l\u2019URL. Deux \u00e9ditions de d\u00e9monstration sont propos\u00e9es pour servir d\u2019exemples de configuration : une \u00e9dition associ\u00e9e au vocabulaire TEI : max_tei_demo ; l\u2019autre associ\u00e9e au vocabulaire EAD : max_ead_demo . Vous pouvez d\u00e9ployer une \u00e9dition de d\u00e9monstration ou directement d\u00e9ployer une nouvelle \u00e9dition . D\u00e9ploiement de l\u2019\u00e9dition de d\u00e9monstration 1) Se placer en ligne de commande dans le dossier tools de MaX : cd [projet-]MaX/tools => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]basex 2) Lancer l\u2019outil de cr\u00e9ation d\u2019une \u00e9dition de d\u00e9monstration si utilisation du port par d\u00e9faut de BaseX (1984) Pour la version EAD d\u00e9mo : ./max.sh --d-ead Pour la version TEI d\u00e9mo : ./max.sh --d-tei 2bis) Lancer l\u2019outil de cr\u00e9ation d\u2019une \u00e9dition de d\u00e9monstration si utilisation d\u2019un autre port (port START modifi\u00e9 dans le fichier .basex , voir \u00e9tape 11 de la proc\u00e9dure d\u2019installation ) Pour la version EAD d\u00e9mo : ./max.sh -p [numero-de-port-START] --d-ead Pour la version TEI d\u00e9mo : ./max.sh -p [numero-de-port-START] --d-tei Nota Bene Attention \u00e0 ne pas confondre le port de la base de donn\u00e9es (1984 par d\u00e9faut) avec le port du service HTTP (8984 par d\u00e9faut). 3) Renseigner les identifiants et mots de passe de BaseX ( par d\u00e9faut admin / admin ) Please type your BaseX login/password : Username:admin Password:admin => Les \u00e9ditions de d\u00e9monstration sont consultables aux adresses suivantes : Pour les ports par d\u00e9faut : http://localhost:8984/max_tei_demo/accueil.html ; http://localhost:8984/max_ead_demo/accueil.html . Pour les ports modifi\u00e9s, il faut renseigner dans l\u2019adresse le num\u00e9ro de port modifi\u00e9 dans le fichier jetty.xml (voir \u00e9tape 12 de la proc\u00e9dure d\u2019installation ) http://localhost:[numero-de-port]/max_tei_demo/accueil.html ; http://localhost:[numero-de-port]/max_ead_demo/accueil.html. Nota Bene Lors du d\u00e9ploiement de l\u2019\u00e9dition de d\u00e9monstration (et seulement pour la d\u00e9monstration), les plugins sont automatiquement activ\u00e9s. Il est donc inutile de proc\u00e9der \u00e0 l\u2019activation manuelle des plugins (voir la section plugins). D\u00e9ploiement d\u2019une nouvelle \u00e9dition 1) Se placer en ligne de commande dans le dossier tools de MaX : cd [projet-]MaX/tools => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]BaseX 2) Cr\u00e9ation de la nouvelle \u00e9dition si utilisation du port par d\u00e9faut de BaseX (1984) ./max.sh -n 2bis) Cr\u00e9ation de la nouvelle \u00e9dition si utilisation d\u2019un autre port (port START modifi\u00e9 dans le fichier .basex , l. 13-14) (voir \u00e9tapes 10-11-12 de la proc\u00e9dure d\u2019installation ) ./max.sh -p [numero-de-port-START] -n 3) Plusieurs questions sont pos\u00e9es afin de renseigner le fichier de configuration mon-edition_config_inc.xml : Project ID ? Saisir le nom du site, sans espace ni caract\u00e8res sp\u00e9ciaux. Exemple : monedition XML Project type (tei, ead, ...) ? Saisir tei ou ead Exemple : tei Database path ? Renseigner le nom de la base de donn\u00e9es XML (sans diacritique, sans espace) Exemple : monedition XML sources path ? Renseigner le chemin complet vers le dossier o\u00f9 se trouvent les sources XML : ce dossier ne doit contenir que des fichiers XML (aucun autre type de fichiers), et uniquement les fichiers XML qui doivent \u00eatre vers\u00e9s dans la base. Exemple : /Users/nom/Documents/fichiersbasex/tei/sources/ Please type your BaseX login/password : Nom d\u2019utilisateur et mot de passe de la base de donn\u00e9es XML BaseX ; par d\u00e9faut admin / admin - Username: admin - Password: admin => Vous pouvez enfin vous connecter en local \u00e0 l\u2019adresse : http://localhost:[numero-de-port]/mon-edition Si le port n\u2019est pas celui par d\u00e9faut, il faut renseigner dans l\u2019adresse celui modifi\u00e9 dans le fichier jetty.xml (voir \u00e9tape 12 de la proc\u00e9dure d\u2019installation ) Exemple pour un port par d\u00e9faut : http://localhost:8984/max_tei_demo Les \u00e9ditions ( max_tei_demo , max_ead_demo , mon-edition , etc.) sont cr\u00e9\u00e9es dans un dossier editions de MaX. Si vous suivez les recommandations d\u2019organisation des dossiers d\u00e9crites dans la partie Recommandations d\u2019architecture : Dans votre dossier [projet] , cr\u00e9er un dossier [projet-]editions . D\u00e9placer chaque nouvelle \u00e9dition cr\u00e9\u00e9e, qui se trouve dans le dossier editions du dossier [projet-]MaX , vers le dossier [projet-]editions que vous venez de cr\u00e9er (le dossier ne doit pas \u00eatre copi\u00e9 mais bien d\u00e9plac\u00e9). En vous pla\u00e7ant au moyen du terminal (ou de l\u2019invite de commande) dans le dossier editions de [projet-]MaX cr\u00e9er un lien symbolique entre ce dossier et l\u2019\u00e9dition qui se trouve dans le dossier [projet-]editions . cd [projet-]MaX/editions ln -s ../../[projet-]editions/max_tei_demo . ou ln -s ../../[projet-]editions/mon-edition . Les configurations des \u00e9ditions sont faites dans les dossiers : editions ; plugins (quand ceux-ci sont activ\u00e9s).","title":"Cr\u00e9ation d'une \u00e9dition"},{"location":"script.html#creation-dedition","text":"Pour cr\u00e9er un site, il faut cr\u00e9er une nouvelle \u00e9dition qui va \u00eatre associ\u00e9e \u00e0 une base de donn\u00e9es XML (BaseX). Le nom de l\u2019\u00e9dition est le nom qui appara\u00eetra dans l\u2019URL. Deux \u00e9ditions de d\u00e9monstration sont propos\u00e9es pour servir d\u2019exemples de configuration : une \u00e9dition associ\u00e9e au vocabulaire TEI : max_tei_demo ; l\u2019autre associ\u00e9e au vocabulaire EAD : max_ead_demo . Vous pouvez d\u00e9ployer une \u00e9dition de d\u00e9monstration ou directement d\u00e9ployer une nouvelle \u00e9dition .","title":"Cr\u00e9ation d\u2019\u00e9dition"},{"location":"script.html#deploiement-de-ledition-de-demonstration","text":"1) Se placer en ligne de commande dans le dossier tools de MaX : cd [projet-]MaX/tools => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]basex 2) Lancer l\u2019outil de cr\u00e9ation d\u2019une \u00e9dition de d\u00e9monstration si utilisation du port par d\u00e9faut de BaseX (1984) Pour la version EAD d\u00e9mo : ./max.sh --d-ead Pour la version TEI d\u00e9mo : ./max.sh --d-tei 2bis) Lancer l\u2019outil de cr\u00e9ation d\u2019une \u00e9dition de d\u00e9monstration si utilisation d\u2019un autre port (port START modifi\u00e9 dans le fichier .basex , voir \u00e9tape 11 de la proc\u00e9dure d\u2019installation ) Pour la version EAD d\u00e9mo : ./max.sh -p [numero-de-port-START] --d-ead Pour la version TEI d\u00e9mo : ./max.sh -p [numero-de-port-START] --d-tei Nota Bene Attention \u00e0 ne pas confondre le port de la base de donn\u00e9es (1984 par d\u00e9faut) avec le port du service HTTP (8984 par d\u00e9faut). 3) Renseigner les identifiants et mots de passe de BaseX ( par d\u00e9faut admin / admin ) Please type your BaseX login/password : Username:admin Password:admin => Les \u00e9ditions de d\u00e9monstration sont consultables aux adresses suivantes : Pour les ports par d\u00e9faut : http://localhost:8984/max_tei_demo/accueil.html ; http://localhost:8984/max_ead_demo/accueil.html . Pour les ports modifi\u00e9s, il faut renseigner dans l\u2019adresse le num\u00e9ro de port modifi\u00e9 dans le fichier jetty.xml (voir \u00e9tape 12 de la proc\u00e9dure d\u2019installation ) http://localhost:[numero-de-port]/max_tei_demo/accueil.html ; http://localhost:[numero-de-port]/max_ead_demo/accueil.html. Nota Bene Lors du d\u00e9ploiement de l\u2019\u00e9dition de d\u00e9monstration (et seulement pour la d\u00e9monstration), les plugins sont automatiquement activ\u00e9s. Il est donc inutile de proc\u00e9der \u00e0 l\u2019activation manuelle des plugins (voir la section plugins).","title":"D\u00e9ploiement de l\u2019\u00e9dition de d\u00e9monstration"},{"location":"script.html#deploiement-dune-nouvelle-edition","text":"1) Se placer en ligne de commande dans le dossier tools de MaX : cd [projet-]MaX/tools => Si le message suivant s\u2019affiche Please install BaseX or set $BASEX_PATH environment variable , il faut alors indiquer le chemin vers le dossier contenant l\u2019application BaseX au moyen de la commande suivante : export BASEX_PATH=../../[projet-]BaseX 2) Cr\u00e9ation de la nouvelle \u00e9dition si utilisation du port par d\u00e9faut de BaseX (1984) ./max.sh -n 2bis) Cr\u00e9ation de la nouvelle \u00e9dition si utilisation d\u2019un autre port (port START modifi\u00e9 dans le fichier .basex , l. 13-14) (voir \u00e9tapes 10-11-12 de la proc\u00e9dure d\u2019installation ) ./max.sh -p [numero-de-port-START] -n 3) Plusieurs questions sont pos\u00e9es afin de renseigner le fichier de configuration mon-edition_config_inc.xml : Project ID ? Saisir le nom du site, sans espace ni caract\u00e8res sp\u00e9ciaux. Exemple : monedition XML Project type (tei, ead, ...) ? Saisir tei ou ead Exemple : tei Database path ? Renseigner le nom de la base de donn\u00e9es XML (sans diacritique, sans espace) Exemple : monedition XML sources path ? Renseigner le chemin complet vers le dossier o\u00f9 se trouvent les sources XML : ce dossier ne doit contenir que des fichiers XML (aucun autre type de fichiers), et uniquement les fichiers XML qui doivent \u00eatre vers\u00e9s dans la base. Exemple : /Users/nom/Documents/fichiersbasex/tei/sources/ Please type your BaseX login/password : Nom d\u2019utilisateur et mot de passe de la base de donn\u00e9es XML BaseX ; par d\u00e9faut admin / admin - Username: admin - Password: admin => Vous pouvez enfin vous connecter en local \u00e0 l\u2019adresse : http://localhost:[numero-de-port]/mon-edition Si le port n\u2019est pas celui par d\u00e9faut, il faut renseigner dans l\u2019adresse celui modifi\u00e9 dans le fichier jetty.xml (voir \u00e9tape 12 de la proc\u00e9dure d\u2019installation ) Exemple pour un port par d\u00e9faut : http://localhost:8984/max_tei_demo Les \u00e9ditions ( max_tei_demo , max_ead_demo , mon-edition , etc.) sont cr\u00e9\u00e9es dans un dossier editions de MaX. Si vous suivez les recommandations d\u2019organisation des dossiers d\u00e9crites dans la partie Recommandations d\u2019architecture : Dans votre dossier [projet] , cr\u00e9er un dossier [projet-]editions . D\u00e9placer chaque nouvelle \u00e9dition cr\u00e9\u00e9e, qui se trouve dans le dossier editions du dossier [projet-]MaX , vers le dossier [projet-]editions que vous venez de cr\u00e9er (le dossier ne doit pas \u00eatre copi\u00e9 mais bien d\u00e9plac\u00e9). En vous pla\u00e7ant au moyen du terminal (ou de l\u2019invite de commande) dans le dossier editions de [projet-]MaX cr\u00e9er un lien symbolique entre ce dossier et l\u2019\u00e9dition qui se trouve dans le dossier [projet-]editions . cd [projet-]MaX/editions ln -s ../../[projet-]editions/max_tei_demo . ou ln -s ../../[projet-]editions/mon-edition . Les configurations des \u00e9ditions sont faites dans les dossiers : editions ; plugins (quand ceux-ci sont activ\u00e9s).","title":"D\u00e9ploiement d\u2019une nouvelle \u00e9dition"},{"location":"static_pages.html","text":"Pages statiques Les pages statiques d\u2019une \u00e9dition sont \u00e9crites en XHTML et se placent dans le dossier [projet-]editions / [edition] / fragments / [langue-locale] . Chaque fichier a pour extension .frag.html . Le dossier [langue-locale] sera nomm\u00e9 fr , pour du fran\u00e7ais, en pour de l\u2019anglais, etc. graph LR; A-->B B-->C C-->D D-->E A[\"projet-editions\"] B[\"mon-edition\"] C[\"fragments\"] D[\"[langue-locale]\"] E(\"page_html.frag.html\") Exemple du fichier accueil.frag.fr , page d\u2019accueil de l\u2019\u00e9dition de d\u00e9montration EAD de max : <div id=\"demo_presentation\" class=\"page\"> <h3>\u00c9dition de d\u00e9monstration [XML-EAD]</h3> <p>On trouve ici une \u00e9dition de d\u00e9monstration pour des corpus de textes en EAD</p> <p>Ceci est la page d\u2019accueil correspondant \u00e0 la fin d\u2019URL max_ead_demo/accueil.html</p> </div> Dans le fichier menu.xml , si le contenu de l\u2019\u00e9l\u00e9ment <target> est, par exemple, presentation.html , le fichier presentation.frag.html qui se trouve dans le dossier [projet-]editions / [edition] / fragments est alors affich\u00e9 sur le site. Le nom de la page statique HTML doit donc \u00eatre celui de l\u2019\u00e9l\u00e9ment <target> du fichier menu.xml . Si le fichier n\u2019existe pas, le navigateur retourne une erreur. Par exemple, dans le fichier menu.xml : <menu> <entry> <id>introduction_oeuvre</id> <target>introduction_oeuvre.html</target> </entry> </menu> L\u2019\u00e9l\u00e9ment <id> introduction_oeuvre est celui d\u00e9clar\u00e9 dans le fichier i18n.xml (cf. supra ) et l\u2019\u00e9l\u00e9ment <target> introduction_oeuvre.html donnera le nom du fichier HTML introduction_oeuvre.frag.html dans le dossier [projet-]editions / [edition] / fragments / [langue-locale] . Il pourra \u00eatre consult\u00e9 \u00e0 l\u2019adresse suivante : http://[host]:[port]/[mon-edition]/introduction_oeuvre.html Voir d\u2019autres exemples dans la section Menu .","title":"Pages HTML statiques"},{"location":"static_pages.html#pages-statiques","text":"Les pages statiques d\u2019une \u00e9dition sont \u00e9crites en XHTML et se placent dans le dossier [projet-]editions / [edition] / fragments / [langue-locale] . Chaque fichier a pour extension .frag.html . Le dossier [langue-locale] sera nomm\u00e9 fr , pour du fran\u00e7ais, en pour de l\u2019anglais, etc. graph LR; A-->B B-->C C-->D D-->E A[\"projet-editions\"] B[\"mon-edition\"] C[\"fragments\"] D[\"[langue-locale]\"] E(\"page_html.frag.html\") Exemple du fichier accueil.frag.fr , page d\u2019accueil de l\u2019\u00e9dition de d\u00e9montration EAD de max : <div id=\"demo_presentation\" class=\"page\"> <h3>\u00c9dition de d\u00e9monstration [XML-EAD]</h3> <p>On trouve ici une \u00e9dition de d\u00e9monstration pour des corpus de textes en EAD</p> <p>Ceci est la page d\u2019accueil correspondant \u00e0 la fin d\u2019URL max_ead_demo/accueil.html</p> </div> Dans le fichier menu.xml , si le contenu de l\u2019\u00e9l\u00e9ment <target> est, par exemple, presentation.html , le fichier presentation.frag.html qui se trouve dans le dossier [projet-]editions / [edition] / fragments est alors affich\u00e9 sur le site. Le nom de la page statique HTML doit donc \u00eatre celui de l\u2019\u00e9l\u00e9ment <target> du fichier menu.xml . Si le fichier n\u2019existe pas, le navigateur retourne une erreur. Par exemple, dans le fichier menu.xml : <menu> <entry> <id>introduction_oeuvre</id> <target>introduction_oeuvre.html</target> </entry> </menu> L\u2019\u00e9l\u00e9ment <id> introduction_oeuvre est celui d\u00e9clar\u00e9 dans le fichier i18n.xml (cf. supra ) et l\u2019\u00e9l\u00e9ment <target> introduction_oeuvre.html donnera le nom du fichier HTML introduction_oeuvre.frag.html dans le dossier [projet-]editions / [edition] / fragments / [langue-locale] . Il pourra \u00eatre consult\u00e9 \u00e0 l\u2019adresse suivante : http://[host]:[port]/[mon-edition]/introduction_oeuvre.html Voir d\u2019autres exemples dans la section Menu .","title":"Pages statiques"},{"location":"text.html","text":"Textes La consultation des textes se fait aux URLs suivantes : consultation d\u2019un fragment identifi\u00e9 sur un document XML : http://[host]:[port]/[edition]/[document].xml/[id].html consultation d\u2019un document XML complet http://[host]:[port]/[edition]/doc/[document].html] consultation \u00ab isol\u00e9e \u00bb, pour afficher le texte seul en dehors du site (c\u2019est-\u00e0-dire sans menu, barre de navigation, etc., par exemple pour l\u2019afficher dans une pop-up) : http://[host]:[port]/[edition]/fragment_html/[id].html . L\u2019ajout du param\u00e8tre ?wrap=true offre une consultation dans une page HTML compl\u00e8te (avec appels aux css et js du site) : http://[host]:[port]/[edition]/fragment_html/[id].html?wrap=true La feuille de transformation appliqu\u00e9e par d\u00e9faut se trouve dans : pour la TEI : [projet-]MaX / ui / xsl / tei / tei.xsl ; pour l\u2019EAD : [projet-]MaX / ui / xsl / ead / ead.xsl . La surcharge de cette transformation se fait en r\u00e9digeant une XSL nomm\u00e9e text_hook.xsl , plac\u00e9e dans le dossier [projet-]editions / [edition] / ui / xsl / [ead ou tei] . graph LR; A-->B B-->C C-->D D-->E E-->F A[\"projet-editions\"] B[\"mon-edition\"] C[\"ui\"] D[\"xsl\"] E[\"ead ou tei\"] F(\"text_hook.xsl\") Cette feuille de transformation dicte au moteur d\u2019affichage de quelle mani\u00e8re les \u00e9l\u00e9ments des documents XML doivent \u00eatre affich\u00e9s (dans quel ordre, si certains \u00e9l\u00e9ments doivent \u00eatre masqu\u00e9s, etc.). C\u2019est ce fichier qui permet de r\u00e9gir ce que l\u2019utilisateur verra lorsqu\u2019il consultera, sur MaX, un document XML ou un fragment de document. Barre de navigation Lors de l\u2019affichage du texte d\u2019un fragment en TEI , la barre de navigation (sous forme de liste d\u00e9roulante) permet de naviguer de fragment en fragment. Les entr\u00e9es de cette liste d\u00e9roulante sont par d\u00e9faut identiques aux entr\u00e9es de la table des mati\u00e8res du document en cours de consultation. La feuille de transformation appliqu\u00e9e par d\u00e9faut se trouve dans : [projet-]MaX / ui / xsl / tei / nav_bar.xsl . Il est possible de modifier son comportement par d\u00e9faut par une surcharge . Pour cela, on r\u00e9dige une XSL nomm\u00e9e nav_bar.xsl , dans le dossier [projet-]editions / [edition] / ui / xsl / tei . Celle-ci recevra en entr\u00e9e le m\u00eame arbre XML que [projet-]editions / [edition] / ui / xsl / tei / document_toc.xsl ainsi que les param\u00e8tres $baseuri , $project accompagn\u00e9s de : $selectedId : identifiant du fragment en cours de consultation $nextArrow : 'true' s\u2019il existe des fragments suivant le fragment courant $prevArrow : 'true' s\u2019il existe des fragments pr\u00e9c\u00e9dant le fragment courant Options de lecture Les options de lecture permettent au lecteur d\u2019afficher ou masquer ( via des cases \u00e0 cocher) certains \u00e9l\u00e9ments textuels (les sauts de page ou de ligne de la version manuscrite par exemple). Ces \u00e9l\u00e9ments doivent \u00eatre d\u00e9clar\u00e9s dans le fichier de configuration de l\u2019\u00e9dition : fichier [mon-edition]_config_inc.xml dans le dossier [projet-]editions/[mon-projet] . Exemple pour proposer l\u2019option afficher/masquer les sauts de page (\u00e9l\u00e9ments <pb/> ) et les sauts de ligne (\u00e9l\u00e9ments <lb/> ) dans un document TEI : [...] <textOptions> <checkboxOptions> <targetClass>pb</targetClass> <targetClass>lb</targetClass> </checkboxOptions> </textOptions> [...] Les \u00e9l\u00e9ments TEI <pb> sont transform\u00e9s en noeud HTML <span> de classe .pb , ils pourront alors \u00eatre affich\u00e9s ou masqu\u00e9s depuis l\u2019interface de consultation. Il est possible de surcharger le fichier i18n.xml afin de sp\u00e9cifier l\u2019option d\u2019affichage. Par exemple : <entry key=\"pb\">Afficher les sauts de page</entry> <entry key=\"lb\">Afficher les sauts de ligne</entry> pb et lb \u00e9tant les \u00e9l\u00e9ments TEI d\u00e9clar\u00e9s dans la balise targetClass du fichier [mon-edition]_config_inc.xml dans l\u2019exemple ci-dessus. Pour les \u00e9l\u00e9ments plus complexes, comme l\u2019affichage de certains \u00e9l\u00e9ments \u00e0 la place d\u2019autres, avec l\u2019utilisation de la balise <choice> notamment, des plugins ont \u00e9t\u00e9 d\u00e9velopp\u00e9s. C\u2019est le cas des plugins ajout , abr\u00e9viation , normalisation , etc. Voir les plugins . Pied de page Un pied de page par d\u00e9faut est configur\u00e9 dans MaX. Il est appel\u00e9 dans le template de mise page (voir gabarits, mise en page ). Pour le modifier, il suffit d'ajouter un fichier footer.frag.html dans le dossier [projet-]editions / [edition] / fragments (voir Pages HTML statiques ). Alignement Cette fonctionnalit\u00e9 permet la consultation d\u2019un fragment en deux versions align\u00e9es. Chaque couple de fragments align\u00e9s doit respecter une nomenclature d\u2019identification : [prefixlang1][identifiant] et [prefixlang2][identifiant] . Les parties de texte qui sont \u00e0 aligner doivent donc avoir un identifiant identique avec le pr\u00e9fixe de la langue. Exemple : fr_p1 et lat_p1 La d\u00e9claration des documents qui doivent \u00eatre consult\u00e9s avec l\u2019alignement se fait dans le fichier de configuration de l\u2019\u00e9dition mon-edition_config_inc.xml . graph LR; A-->B B-->C A[\"projet-editions\"] B[\"mon-edition\"] C(\"mon-edition_config_inc.xml\") Il faut alors pr\u00e9ciser le document (attribut @document ) ainsi que les pr\u00e9fixes d\u2019identifications utilis\u00e9s (attributs @first-prefix et @second-prefix ) dans les sources. L\u2019attribut @first-prefix correspondant \u00e0 la langue qui sera affich\u00e9e en colonne de gauche. Cela suppose que les deux fichiers portent le m\u00eame nom, avec un pr\u00e9fixe de langue diff\u00e9rent. Par exemple : <alignment document=\"FR_Ramusio.xml\" first-prefix=\"fr\" second-prefix=\"it\"/> <!-- Le fichier FR_Ramusio.xml --> <p n=\"10\" xml:id=\"fr_Ramu_2_5_p1\">La terre du Br\u00e9sil est situ\u00e9e au-del\u00e0 de l\u2019\u00e9quinoxiale dans la partie australe vers l\u2019Occident, distante de la ligne diam\u00e9trale de 10 degr\u00e9s de longitude et, commen\u00e7ant \u00e0 3 degr\u00e9s de latitude australe, elle s\u2019\u00e9tend jusqu\u2019\u00e0 52 degr\u00e9s vers le p\u00f4le antarctique, o\u00f9 se trouve le cap des onze mille vierges, \u00e0 l\u2019entr\u00e9e du d\u00e9troit dit de Magellan [...] <!-- Le fichier IT_Ramusio.xml --> <p n=\"10\" xml:id=\"it_Ramu_2_5_p1\">La terra del Braf\u00ecl \u00e8 posta oltra l\u2019equinottiale nella parte australe verso occidente, distante dalla linea diametrale gradi dieci di longitudine, &amp; cominciando da tre gradi di latitudine australe corre fino \u00e0 cinquantadua verso il polo antartico, doue \u00e8 il capo delle vndici mila vergini nell\u2019entrare del stretto detto di Magallanes [...] R\u00e9cup\u00e9ration et affichage de fragments hors contexte Lors de la consultation d\u2019un fragment, il peut s\u2019av\u00e9rer n\u00e9cessaire d\u2019afficher du contenu issu d\u2019un ou plusieurs autres fragments. L\u2019ajout d\u2019une XQUERY nomm\u00e9e text_hook.xq dans le dossier [projet-]editions / [edition] / xq offre cette fonctionnalit\u00e9. Celle-ci sera automatiquement ex\u00e9cut\u00e9e lors de la consultation d\u2019un fragment ou d\u2019un document complet. graph LR; A-->B B-->C C-->D A[\"projet-editions\"] B[\"mon-edition\"] C[\"xq\"] D(\"text_hook.xq\") Il est \u00e9galement possible d\u2019int\u00e9grer une transformation XSL au sein de cette fonction XQUERY. Cette fonction re\u00e7oit les param\u00e8tres $baseURI , $dbPath , $project et $doc . Exemple : declare variable $baseURI external; declare variable $dbPath external; (:path du document dans la db:) declare variable $project external; (: id du projet :) declare variable $doc external; (: nom du document :) let $document := doc($dbPath || '/' || $doc) return base-uri($document) Marquage d\u2019occurrences et focus (pour des sources en TEI) Il est possible de mettre en \u00e9vidence les occurences d\u2019une cha\u00eene de caract\u00e8res et/ou de mettre le focus sur un fragment identifi\u00e9 d\u2019une page \u00e0 l\u2019aide des param\u00e8tres search et focus pour les 2 URLs (ou routes) suivantes : consultation d\u2019un fragment identifi\u00e9 : http://[host]:[port]/[edition]/[document].xml/[id].html consultation d\u2019un document complet : http://[host]:[port]/[edition]/doc/[document].html Le marquage d\u2019occurrences se fait par l\u2019ajout du param\u00e8tre search : http://[host]:[port]/[edition]/[document].xml/[id].html?search=[texte recherch\u00e9] Le focus sur un fragment identifi\u00e9 se fait par l\u2019ajout du param\u00e8tre focus : http://[host]:[port]/[edition]/[document].xml/[id].html?focus=[identifiant fragment] Il est possible de combiner les deux param\u00e8tres : http://[host]:[port]/[edition]/[document].xml/[id].html?search=[texte recherch\u00e9]&focus=[identifiant fragment]","title":"Textes"},{"location":"text.html#textes","text":"La consultation des textes se fait aux URLs suivantes : consultation d\u2019un fragment identifi\u00e9 sur un document XML : http://[host]:[port]/[edition]/[document].xml/[id].html consultation d\u2019un document XML complet http://[host]:[port]/[edition]/doc/[document].html] consultation \u00ab isol\u00e9e \u00bb, pour afficher le texte seul en dehors du site (c\u2019est-\u00e0-dire sans menu, barre de navigation, etc., par exemple pour l\u2019afficher dans une pop-up) : http://[host]:[port]/[edition]/fragment_html/[id].html . L\u2019ajout du param\u00e8tre ?wrap=true offre une consultation dans une page HTML compl\u00e8te (avec appels aux css et js du site) : http://[host]:[port]/[edition]/fragment_html/[id].html?wrap=true La feuille de transformation appliqu\u00e9e par d\u00e9faut se trouve dans : pour la TEI : [projet-]MaX / ui / xsl / tei / tei.xsl ; pour l\u2019EAD : [projet-]MaX / ui / xsl / ead / ead.xsl . La surcharge de cette transformation se fait en r\u00e9digeant une XSL nomm\u00e9e text_hook.xsl , plac\u00e9e dans le dossier [projet-]editions / [edition] / ui / xsl / [ead ou tei] . graph LR; A-->B B-->C C-->D D-->E E-->F A[\"projet-editions\"] B[\"mon-edition\"] C[\"ui\"] D[\"xsl\"] E[\"ead ou tei\"] F(\"text_hook.xsl\") Cette feuille de transformation dicte au moteur d\u2019affichage de quelle mani\u00e8re les \u00e9l\u00e9ments des documents XML doivent \u00eatre affich\u00e9s (dans quel ordre, si certains \u00e9l\u00e9ments doivent \u00eatre masqu\u00e9s, etc.). C\u2019est ce fichier qui permet de r\u00e9gir ce que l\u2019utilisateur verra lorsqu\u2019il consultera, sur MaX, un document XML ou un fragment de document.","title":"Textes"},{"location":"text.html#barre-de-navigation","text":"Lors de l\u2019affichage du texte d\u2019un fragment en TEI , la barre de navigation (sous forme de liste d\u00e9roulante) permet de naviguer de fragment en fragment. Les entr\u00e9es de cette liste d\u00e9roulante sont par d\u00e9faut identiques aux entr\u00e9es de la table des mati\u00e8res du document en cours de consultation. La feuille de transformation appliqu\u00e9e par d\u00e9faut se trouve dans : [projet-]MaX / ui / xsl / tei / nav_bar.xsl . Il est possible de modifier son comportement par d\u00e9faut par une surcharge . Pour cela, on r\u00e9dige une XSL nomm\u00e9e nav_bar.xsl , dans le dossier [projet-]editions / [edition] / ui / xsl / tei . Celle-ci recevra en entr\u00e9e le m\u00eame arbre XML que [projet-]editions / [edition] / ui / xsl / tei / document_toc.xsl ainsi que les param\u00e8tres $baseuri , $project accompagn\u00e9s de : $selectedId : identifiant du fragment en cours de consultation $nextArrow : 'true' s\u2019il existe des fragments suivant le fragment courant $prevArrow : 'true' s\u2019il existe des fragments pr\u00e9c\u00e9dant le fragment courant","title":"Barre de navigation"},{"location":"text.html#options-de-lecture","text":"Les options de lecture permettent au lecteur d\u2019afficher ou masquer ( via des cases \u00e0 cocher) certains \u00e9l\u00e9ments textuels (les sauts de page ou de ligne de la version manuscrite par exemple). Ces \u00e9l\u00e9ments doivent \u00eatre d\u00e9clar\u00e9s dans le fichier de configuration de l\u2019\u00e9dition : fichier [mon-edition]_config_inc.xml dans le dossier [projet-]editions/[mon-projet] . Exemple pour proposer l\u2019option afficher/masquer les sauts de page (\u00e9l\u00e9ments <pb/> ) et les sauts de ligne (\u00e9l\u00e9ments <lb/> ) dans un document TEI : [...] <textOptions> <checkboxOptions> <targetClass>pb</targetClass> <targetClass>lb</targetClass> </checkboxOptions> </textOptions> [...] Les \u00e9l\u00e9ments TEI <pb> sont transform\u00e9s en noeud HTML <span> de classe .pb , ils pourront alors \u00eatre affich\u00e9s ou masqu\u00e9s depuis l\u2019interface de consultation. Il est possible de surcharger le fichier i18n.xml afin de sp\u00e9cifier l\u2019option d\u2019affichage. Par exemple : <entry key=\"pb\">Afficher les sauts de page</entry> <entry key=\"lb\">Afficher les sauts de ligne</entry> pb et lb \u00e9tant les \u00e9l\u00e9ments TEI d\u00e9clar\u00e9s dans la balise targetClass du fichier [mon-edition]_config_inc.xml dans l\u2019exemple ci-dessus. Pour les \u00e9l\u00e9ments plus complexes, comme l\u2019affichage de certains \u00e9l\u00e9ments \u00e0 la place d\u2019autres, avec l\u2019utilisation de la balise <choice> notamment, des plugins ont \u00e9t\u00e9 d\u00e9velopp\u00e9s. C\u2019est le cas des plugins ajout , abr\u00e9viation , normalisation , etc. Voir les plugins .","title":"Options de lecture"},{"location":"text.html#pied-de-page","text":"Un pied de page par d\u00e9faut est configur\u00e9 dans MaX. Il est appel\u00e9 dans le template de mise page (voir gabarits, mise en page ). Pour le modifier, il suffit d'ajouter un fichier footer.frag.html dans le dossier [projet-]editions / [edition] / fragments (voir Pages HTML statiques ).","title":"Pied de page"},{"location":"text.html#alignement","text":"Cette fonctionnalit\u00e9 permet la consultation d\u2019un fragment en deux versions align\u00e9es. Chaque couple de fragments align\u00e9s doit respecter une nomenclature d\u2019identification : [prefixlang1][identifiant] et [prefixlang2][identifiant] . Les parties de texte qui sont \u00e0 aligner doivent donc avoir un identifiant identique avec le pr\u00e9fixe de la langue. Exemple : fr_p1 et lat_p1 La d\u00e9claration des documents qui doivent \u00eatre consult\u00e9s avec l\u2019alignement se fait dans le fichier de configuration de l\u2019\u00e9dition mon-edition_config_inc.xml . graph LR; A-->B B-->C A[\"projet-editions\"] B[\"mon-edition\"] C(\"mon-edition_config_inc.xml\") Il faut alors pr\u00e9ciser le document (attribut @document ) ainsi que les pr\u00e9fixes d\u2019identifications utilis\u00e9s (attributs @first-prefix et @second-prefix ) dans les sources. L\u2019attribut @first-prefix correspondant \u00e0 la langue qui sera affich\u00e9e en colonne de gauche. Cela suppose que les deux fichiers portent le m\u00eame nom, avec un pr\u00e9fixe de langue diff\u00e9rent. Par exemple : <alignment document=\"FR_Ramusio.xml\" first-prefix=\"fr\" second-prefix=\"it\"/> <!-- Le fichier FR_Ramusio.xml --> <p n=\"10\" xml:id=\"fr_Ramu_2_5_p1\">La terre du Br\u00e9sil est situ\u00e9e au-del\u00e0 de l\u2019\u00e9quinoxiale dans la partie australe vers l\u2019Occident, distante de la ligne diam\u00e9trale de 10 degr\u00e9s de longitude et, commen\u00e7ant \u00e0 3 degr\u00e9s de latitude australe, elle s\u2019\u00e9tend jusqu\u2019\u00e0 52 degr\u00e9s vers le p\u00f4le antarctique, o\u00f9 se trouve le cap des onze mille vierges, \u00e0 l\u2019entr\u00e9e du d\u00e9troit dit de Magellan [...] <!-- Le fichier IT_Ramusio.xml --> <p n=\"10\" xml:id=\"it_Ramu_2_5_p1\">La terra del Braf\u00ecl \u00e8 posta oltra l\u2019equinottiale nella parte australe verso occidente, distante dalla linea diametrale gradi dieci di longitudine, &amp; cominciando da tre gradi di latitudine australe corre fino \u00e0 cinquantadua verso il polo antartico, doue \u00e8 il capo delle vndici mila vergini nell\u2019entrare del stretto detto di Magallanes [...]","title":"Alignement"},{"location":"text.html#recuperation-et-affichage-de-fragments-hors-contexte","text":"Lors de la consultation d\u2019un fragment, il peut s\u2019av\u00e9rer n\u00e9cessaire d\u2019afficher du contenu issu d\u2019un ou plusieurs autres fragments. L\u2019ajout d\u2019une XQUERY nomm\u00e9e text_hook.xq dans le dossier [projet-]editions / [edition] / xq offre cette fonctionnalit\u00e9. Celle-ci sera automatiquement ex\u00e9cut\u00e9e lors de la consultation d\u2019un fragment ou d\u2019un document complet. graph LR; A-->B B-->C C-->D A[\"projet-editions\"] B[\"mon-edition\"] C[\"xq\"] D(\"text_hook.xq\") Il est \u00e9galement possible d\u2019int\u00e9grer une transformation XSL au sein de cette fonction XQUERY. Cette fonction re\u00e7oit les param\u00e8tres $baseURI , $dbPath , $project et $doc . Exemple : declare variable $baseURI external; declare variable $dbPath external; (:path du document dans la db:) declare variable $project external; (: id du projet :) declare variable $doc external; (: nom du document :) let $document := doc($dbPath || '/' || $doc) return base-uri($document)","title":"R\u00e9cup\u00e9ration et affichage de fragments hors contexte"},{"location":"text.html#marquage-doccurrences-et-focus-pour-des-sources-en-tei","text":"Il est possible de mettre en \u00e9vidence les occurences d\u2019une cha\u00eene de caract\u00e8res et/ou de mettre le focus sur un fragment identifi\u00e9 d\u2019une page \u00e0 l\u2019aide des param\u00e8tres search et focus pour les 2 URLs (ou routes) suivantes : consultation d\u2019un fragment identifi\u00e9 : http://[host]:[port]/[edition]/[document].xml/[id].html consultation d\u2019un document complet : http://[host]:[port]/[edition]/doc/[document].html Le marquage d\u2019occurrences se fait par l\u2019ajout du param\u00e8tre search : http://[host]:[port]/[edition]/[document].xml/[id].html?search=[texte recherch\u00e9] Le focus sur un fragment identifi\u00e9 se fait par l\u2019ajout du param\u00e8tre focus : http://[host]:[port]/[edition]/[document].xml/[id].html?focus=[identifiant fragment] Il est possible de combiner les deux param\u00e8tres : http://[host]:[port]/[edition]/[document].xml/[id].html?search=[texte recherch\u00e9]&focus=[identifiant fragment]","title":"Marquage d\u2019occurrences et focus (pour des sources en TEI)"},{"location":"toc.html","text":"Sommaires Sommaire d\u2019une \u00e9dition Le sommaire d\u2019une \u00e9dition est disponible \u00e0 l\u2019URL http://[host]:[port]/[edition]/sommaire.html Par exemple : http://localhost:17002/mon-edition/sommaire.html Par d\u00e9faut, la page de sommaire liste les documents pr\u00e9sents dans la collection, par ordre alphab\u00e9tique, en affichant : pour la TEI, les \u00e9l\u00e9ments : /tei:TEI/tei:teiHeader/tei:fileDesc/tei:titleStmt pour l\u2019EAD, les \u00e9l\u00e9ments : /ead:ead/ead:eadheader/ead:filedesc/ead:titlestmt Les requ\u00eates XQuery correspondantes se trouvent dans le fichier [projet-]MaX / rxq / toc.xqm Le r\u00e9sultat de la requ\u00eate est ensuite transform\u00e9 par la xsl [projet-]MaX / ui / xsl / core / toc.xsl Dans le cas o\u00f9 les fichiers XML sont organis\u00e9s en dossiers et sous-dossiers, l\u2019arborescence est restitu\u00e9e dans le sommaire. Voir l\u2019\u00e9dition de d\u00e9monstration EAD . Surcharge du comportement Il est possible de : modifier la XQuery afin de modifier les entr\u00e9es list\u00e9es dans le sommaire (ou leur ordre de tri), modifier la XSL transformant cette liste des entr\u00e9es au format HTML. Modification de la XQuery Pour modifier la Xquery, il convient de : Cr\u00e9er un fichier toc.xq dans le dossier [projet-]editions / [edition] / xq . Y r\u00e9diger une requ\u00eate Xquery prenant en compte 3 param\u00e8tres : $baseURI : valeur de la variable de configuration baseURI $dbPath : valeur de la variable de configuration dbPath permettant le requ\u00eatage de la base de donn\u00e9es $project : identifiant de l\u2019\u00e9dition. Exemple de squelette d\u2019une telle XQuery : declare variable $baseURI external; declare variable $dbPath external; declare variable $project external; <ul> [...] <ul> Afin d\u2019\u00eatre compatible avec la XSL de la table des mati\u00e8res par d\u00e9faut de MaX (fichier [projet-]MaX / ui / xsl / core / toc.xsl ), cette XQuery doit g\u00e9n\u00e9rer un \u00e9l\u00e9ment <ul> compos\u00e9 d\u2019\u00e9l\u00e9ments <li> (eux-m\u00eames compos\u00e9s d\u2019\u00e9l\u00e9ments <ul> s\u2019il y a besoin de listes imbriqu\u00e9es). Les valeurs des liens devront \u00eatre renseign\u00e9es en valeur de l\u2019attribut data-href de l\u2019\u00e9l\u00e9ment <li> . Exemple de listing (g\u00e9n\u00e9r\u00e9 par la XQuery par d\u00e9faut de MaX) compatible avec [projet-]MaX / ui / xsl / core / toc.xsl : <ul> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_align_fr.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lipsum align\u00e9 - Version fran\u00e7aise / traduction latine.</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_align_lat.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lipsum - Version Latine.</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_lorem.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lorem Ipsum <lb></lb>In <hi rend=\"small-caps\">MaX</hi> - Corrections, notes &amp; sauts de page</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_lorem_2.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lorem Ipsum In MaX - Tome 2. Apparat critique</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_lorem_3.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lorem Ipsum in MaX - Tome 3. Images et \u00c9quations</title> </li> </ul> Modification de la XSL Pour modifier la XSL par d\u00e9faut, il faut cr\u00e9er un fichier toc.xsl dans le dossier [projet-]editions / [edition] / ui / xsl / core . Cette XSL permet de transformer le r\u00e9sultat de la XQuery par d\u00e9faut, ou celle qui la surcharge, ( [projet-]editions / [edition] / xq / toc.xq ) en HTML. En l\u2019absence d\u2019un tel fichier, MaX ex\u00e9cutera [projet-]MaX / ui / xsl / core / toc.xsl . Sommaire d\u2019un document Le sommaire d\u2019un document est disponible en consultant l\u2019URL : http://[host]:[port]/[edition]/sommaire/[document].html Par exemple : http://localhost:17002/mon-edition/sommaire/document.html Par d\u00e9faut, MaX parcourt le document XML, mentionn\u00e9 dans l\u2019URL, et affiche : pour la TEI : les \u00e9l\u00e9ments <head> des \u00e9l\u00e9ments <div> identifi\u00e9s (avec un attribut @xml:id ) contenant un attribut @type ; pour l\u2019EAD : les balises <unittitle> et <unitid> des composants (\u00e9l\u00e9ments <archdesc> et <c> ) identifi\u00e9s. Les requ\u00eates XQuery correspondantes sont stock\u00e9es dans : pour la TEI : [projet-]MaX / rxq / tei / document_toc.xq , pour l\u2019EAD : [projet-]MaX / rxq / ead / document_toc.xq . Le r\u00e9sultat de cette requ\u00eate est ensuite transform\u00e9 par la xsl : pour la TEI : [projet-]MaX / ui / xsl / tei / document_toc.xsl pour l\u2019EAD : [projet-]MaX / ui / xsl / ead / document_toc.xsl Titre du document Par d\u00e9faut, le titre du document est : pour la TEI : /tei:TEI/tei:teiHeader/tei:fileDesc/tei:titleStmt pour l\u2019EAD : /ead:ead/ead:eadheader/ead:filedesc/ead:titlestmt Une fonction Xquery permet d\u2019afficher le titre du document : max.util:getDocTitle($dbName, $docPath, $xmlFormat) <!-- exemple d\u2019utilisation --> let $title:= max.util:getDocTitle(max.config:getProjectDBPath($project), $docName, max.config:getXMLFormat($project)) Surcharge du comportement Tout comme le sommaire d\u2019une \u00e9dition, il est possible de : modifier la XQuery afin de modifier les \u00e9l\u00e9ments s\u00e9lectionn\u00e9s pour le sommaire, modifier la XSL transformant ces \u00e9l\u00e9ments au format HTML. Modification de la XQuery Cr\u00e9er un fichier [projet-]editions / [edition] / xq / document_toc.xq Y r\u00e9diger une requ\u00eate Xquery prenant en compte 4 param\u00e8tres : $baseURI : valeur de la variable de configuration baseURI , $dbPath : valeur de la variable de configuration dbPath , $project : identifiant de l\u2019\u00e9dition, $doc : nom du document courant pour lequel est construite la table des mati\u00e8res. Exemple de squelette d\u2019une telle XQuery : declare variable $baseURI external; declare variable $dbPath external; declare variable $project external; declare variable $doc external; (: xquery listant les items du sommaire du document $doc:) <ul> { for $entry in doc($dbPath || '/' || $doc)// ... return <li id=\"...\" data-href=\"...\"><head>...</head></li> } </ul> Afin d\u2019\u00eatre compatible avec la feuille de transformation XSL appliqu\u00e9e par d\u00e9faut au r\u00e9sultat de cette XQuery, celle-ci doit : retourner le sommaire dans un \u00e9lement <ul> , construire des sous-\u00e9l\u00e9ments <li> pour chaque entr\u00e9e en sp\u00e9cifiant l\u2019url des liens dans un attribut @data-href , construire un sous-\u00e9lement <head> pour chaque <li> , contenant le libell\u00e9 de l\u2019entr\u00e9e. Modification de la XSL La XSL par d\u00e9faut peut \u00e9galement \u00eatre surcharg\u00e9e : Il faut alors cr\u00e9er un fichier document_toc.xsl , dans le dossier [projet-]editions / [edition] / ui / xsl / [tei ou ead] . Cette XSL permet de transformer le r\u00e9sultat de la XQuery (XQuery par d\u00e9faut ou surcharge pr\u00e9sente dans [projet-]editions / [edition] / xq / document_toc.xq ) en HTML. Cette XSL re\u00e7oit en entr\u00e9e : le titre du document courant dans une variable $docTitle , les variables de configuration $baseuri et $project . En l\u2019absence d\u2019un tel fichier, MaX ex\u00e9cutera [projet-]MaX / ui / xsl / [tei ou ead] / document_toc.xsl .","title":"Sommaires"},{"location":"toc.html#sommaires","text":"","title":"Sommaires"},{"location":"toc.html#sommaire-dune-edition","text":"Le sommaire d\u2019une \u00e9dition est disponible \u00e0 l\u2019URL http://[host]:[port]/[edition]/sommaire.html Par exemple : http://localhost:17002/mon-edition/sommaire.html Par d\u00e9faut, la page de sommaire liste les documents pr\u00e9sents dans la collection, par ordre alphab\u00e9tique, en affichant : pour la TEI, les \u00e9l\u00e9ments : /tei:TEI/tei:teiHeader/tei:fileDesc/tei:titleStmt pour l\u2019EAD, les \u00e9l\u00e9ments : /ead:ead/ead:eadheader/ead:filedesc/ead:titlestmt Les requ\u00eates XQuery correspondantes se trouvent dans le fichier [projet-]MaX / rxq / toc.xqm Le r\u00e9sultat de la requ\u00eate est ensuite transform\u00e9 par la xsl [projet-]MaX / ui / xsl / core / toc.xsl Dans le cas o\u00f9 les fichiers XML sont organis\u00e9s en dossiers et sous-dossiers, l\u2019arborescence est restitu\u00e9e dans le sommaire. Voir l\u2019\u00e9dition de d\u00e9monstration EAD .","title":"Sommaire d\u2019une \u00e9dition"},{"location":"toc.html#surcharge-du-comportement","text":"Il est possible de : modifier la XQuery afin de modifier les entr\u00e9es list\u00e9es dans le sommaire (ou leur ordre de tri), modifier la XSL transformant cette liste des entr\u00e9es au format HTML.","title":"Surcharge du comportement"},{"location":"toc.html#modification-de-la-xquery","text":"Pour modifier la Xquery, il convient de : Cr\u00e9er un fichier toc.xq dans le dossier [projet-]editions / [edition] / xq . Y r\u00e9diger une requ\u00eate Xquery prenant en compte 3 param\u00e8tres : $baseURI : valeur de la variable de configuration baseURI $dbPath : valeur de la variable de configuration dbPath permettant le requ\u00eatage de la base de donn\u00e9es $project : identifiant de l\u2019\u00e9dition. Exemple de squelette d\u2019une telle XQuery : declare variable $baseURI external; declare variable $dbPath external; declare variable $project external; <ul> [...] <ul> Afin d\u2019\u00eatre compatible avec la XSL de la table des mati\u00e8res par d\u00e9faut de MaX (fichier [projet-]MaX / ui / xsl / core / toc.xsl ), cette XQuery doit g\u00e9n\u00e9rer un \u00e9l\u00e9ment <ul> compos\u00e9 d\u2019\u00e9l\u00e9ments <li> (eux-m\u00eames compos\u00e9s d\u2019\u00e9l\u00e9ments <ul> s\u2019il y a besoin de listes imbriqu\u00e9es). Les valeurs des liens devront \u00eatre renseign\u00e9es en valeur de l\u2019attribut data-href de l\u2019\u00e9l\u00e9ment <li> . Exemple de listing (g\u00e9n\u00e9r\u00e9 par la XQuery par d\u00e9faut de MaX) compatible avec [projet-]MaX / ui / xsl / core / toc.xsl : <ul> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_align_fr.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lipsum align\u00e9 - Version fran\u00e7aise / traduction latine.</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_align_lat.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lipsum - Version Latine.</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_lorem.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lorem Ipsum <lb></lb>In <hi rend=\"small-caps\">MaX</hi> - Corrections, notes &amp; sauts de page</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_lorem_2.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lorem Ipsum In MaX - Tome 2. Apparat critique</title> </li> <li data-depth=\"0\" data-href=\"/demo_lorem/sommaire/demo_lorem_3.xml\"> <title xmlns=\"http://www.tei-c.org/ns/1.0\">Lorem Ipsum in MaX - Tome 3. Images et \u00c9quations</title> </li> </ul>","title":"Modification de la XQuery"},{"location":"toc.html#modification-de-la-xsl","text":"Pour modifier la XSL par d\u00e9faut, il faut cr\u00e9er un fichier toc.xsl dans le dossier [projet-]editions / [edition] / ui / xsl / core . Cette XSL permet de transformer le r\u00e9sultat de la XQuery par d\u00e9faut, ou celle qui la surcharge, ( [projet-]editions / [edition] / xq / toc.xq ) en HTML. En l\u2019absence d\u2019un tel fichier, MaX ex\u00e9cutera [projet-]MaX / ui / xsl / core / toc.xsl .","title":"Modification de la XSL"},{"location":"toc.html#sommaire-dun-document","text":"Le sommaire d\u2019un document est disponible en consultant l\u2019URL : http://[host]:[port]/[edition]/sommaire/[document].html Par exemple : http://localhost:17002/mon-edition/sommaire/document.html Par d\u00e9faut, MaX parcourt le document XML, mentionn\u00e9 dans l\u2019URL, et affiche : pour la TEI : les \u00e9l\u00e9ments <head> des \u00e9l\u00e9ments <div> identifi\u00e9s (avec un attribut @xml:id ) contenant un attribut @type ; pour l\u2019EAD : les balises <unittitle> et <unitid> des composants (\u00e9l\u00e9ments <archdesc> et <c> ) identifi\u00e9s. Les requ\u00eates XQuery correspondantes sont stock\u00e9es dans : pour la TEI : [projet-]MaX / rxq / tei / document_toc.xq , pour l\u2019EAD : [projet-]MaX / rxq / ead / document_toc.xq . Le r\u00e9sultat de cette requ\u00eate est ensuite transform\u00e9 par la xsl : pour la TEI : [projet-]MaX / ui / xsl / tei / document_toc.xsl pour l\u2019EAD : [projet-]MaX / ui / xsl / ead / document_toc.xsl","title":"Sommaire d\u2019un document"},{"location":"toc.html#titre-du-document","text":"Par d\u00e9faut, le titre du document est : pour la TEI : /tei:TEI/tei:teiHeader/tei:fileDesc/tei:titleStmt pour l\u2019EAD : /ead:ead/ead:eadheader/ead:filedesc/ead:titlestmt Une fonction Xquery permet d\u2019afficher le titre du document : max.util:getDocTitle($dbName, $docPath, $xmlFormat) <!-- exemple d\u2019utilisation --> let $title:= max.util:getDocTitle(max.config:getProjectDBPath($project), $docName, max.config:getXMLFormat($project))","title":"Titre du document"},{"location":"toc.html#surcharge-du-comportement_1","text":"Tout comme le sommaire d\u2019une \u00e9dition, il est possible de : modifier la XQuery afin de modifier les \u00e9l\u00e9ments s\u00e9lectionn\u00e9s pour le sommaire, modifier la XSL transformant ces \u00e9l\u00e9ments au format HTML.","title":"Surcharge du comportement"},{"location":"toc.html#modification-de-la-xquery_1","text":"Cr\u00e9er un fichier [projet-]editions / [edition] / xq / document_toc.xq Y r\u00e9diger une requ\u00eate Xquery prenant en compte 4 param\u00e8tres : $baseURI : valeur de la variable de configuration baseURI , $dbPath : valeur de la variable de configuration dbPath , $project : identifiant de l\u2019\u00e9dition, $doc : nom du document courant pour lequel est construite la table des mati\u00e8res. Exemple de squelette d\u2019une telle XQuery : declare variable $baseURI external; declare variable $dbPath external; declare variable $project external; declare variable $doc external; (: xquery listant les items du sommaire du document $doc:) <ul> { for $entry in doc($dbPath || '/' || $doc)// ... return <li id=\"...\" data-href=\"...\"><head>...</head></li> } </ul> Afin d\u2019\u00eatre compatible avec la feuille de transformation XSL appliqu\u00e9e par d\u00e9faut au r\u00e9sultat de cette XQuery, celle-ci doit : retourner le sommaire dans un \u00e9lement <ul> , construire des sous-\u00e9l\u00e9ments <li> pour chaque entr\u00e9e en sp\u00e9cifiant l\u2019url des liens dans un attribut @data-href , construire un sous-\u00e9lement <head> pour chaque <li> , contenant le libell\u00e9 de l\u2019entr\u00e9e.","title":"Modification de la XQuery"},{"location":"toc.html#modification-de-la-xsl_1","text":"La XSL par d\u00e9faut peut \u00e9galement \u00eatre surcharg\u00e9e : Il faut alors cr\u00e9er un fichier document_toc.xsl , dans le dossier [projet-]editions / [edition] / ui / xsl / [tei ou ead] . Cette XSL permet de transformer le r\u00e9sultat de la XQuery (XQuery par d\u00e9faut ou surcharge pr\u00e9sente dans [projet-]editions / [edition] / xq / document_toc.xq ) en HTML. Cette XSL re\u00e7oit en entr\u00e9e : le titre du document courant dans une variable $docTitle , les variables de configuration $baseuri et $project . En l\u2019absence d\u2019un tel fichier, MaX ex\u00e9cutera [projet-]MaX / ui / xsl / [tei ou ead] / document_toc.xsl .","title":"Modification de la XSL"}]}